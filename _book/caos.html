<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 5 Casos prácticos | Visualización y geolocalización de datos</title>
  <meta name="description" content="Máster en Data Science &amp; Business Analytics (con R Software)" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 5 Casos prácticos | Visualización y geolocalización de datos" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://mdsr-2122-visualizacion.netlify.app/" />
  
  <meta property="og:description" content="Máster en Data Science &amp; Business Analytics (con R Software)" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 5 Casos prácticos | Visualización y geolocalización de datos" />
  
  <meta name="twitter:description" content="Máster en Data Science &amp; Business Analytics (con R Software)" />
  

<meta name="author" content="Diego Hernangómez" />
<meta name="author" content="Gema Fernández-Avilés" />


<meta name="date" content="2022-02-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dep-esp.html"/>
<link rel="next" href="referencias.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Visualización y geolocalización de datos</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prólogo</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#por-qué-leer-este-libro"><i class="fa fa-check"></i>¿Por qué leer este libro?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#objetivos-de-aprendizaje"><i class="fa fa-check"></i>Objetivos de aprendizaje</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-libro"><i class="fa fa-check"></i>Estructura del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#datos"><i class="fa fa-check"></i>Datos</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="la-revolución-de-los-geodatos.html"><a href="la-revolución-de-los-geodatos.html"><i class="fa fa-check"></i><b>1</b> La revolución de los geodatos</a></li>
<li class="chapter" data-level="2" data-path="datos-geográficos.html"><a href="datos-geográficos.html"><i class="fa fa-check"></i><b>2</b> Datos geográficos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="datos-geográficos.html"><a href="datos-geográficos.html#contexto-general"><i class="fa fa-check"></i><b>2.1</b> Contexto general</a></li>
<li class="chapter" data-level="2.2" data-path="datos-geográficos.html"><a href="datos-geográficos.html#conceptos-clave"><i class="fa fa-check"></i><b>2.2</b> Conceptos clave</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="formatos.html"><a href="formatos.html"><i class="fa fa-check"></i><b>3</b> Formatos de datos espaciales</a>
<ul>
<li class="chapter" data-level="3.1" data-path="formatos.html"><a href="formatos.html#ficheros-de-datos-espaciales"><i class="fa fa-check"></i><b>3.1</b> Ficheros de datos espaciales</a></li>
<li class="chapter" data-level="3.2" data-path="formatos.html"><a href="formatos.html#modelo-de-datos"><i class="fa fa-check"></i><b>3.2</b> Modelo de datos</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="formatos.html"><a href="formatos.html#vec"><i class="fa fa-check"></i><b>3.2.1</b> Datos de vectores</a></li>
<li class="chapter" data-level="3.2.2" data-path="formatos.html"><a href="formatos.html#raster"><i class="fa fa-check"></i><b>3.2.2</b> Datos ráster</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="formatos.html"><a href="formatos.html#CRS"><i class="fa fa-check"></i><b>3.3</b> Sistema de Referencia de Coordenadas (CRS)</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="formatos.html"><a href="formatos.html#tipos-de-crs"><i class="fa fa-check"></i><b>3.3.1</b> Tipos de CRS</a></li>
<li class="chapter" data-level="3.3.2" data-path="formatos.html"><a href="formatos.html#trabajando-con-proyecciones-en-r"><i class="fa fa-check"></i><b>3.3.2</b> Trabajando con proyecciones en R</a></li>
<li class="chapter" data-level="3.3.3" data-path="formatos.html"><a href="formatos.html#quecrsuso"><i class="fa fa-check"></i><b>3.3.3</b> ¿Qué proyección uso?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dep-esp.html"><a href="dep-esp.html"><i class="fa fa-check"></i><b>4</b> Estadística espacial</a>
<ul>
<li class="chapter" data-level="4.1" data-path="dep-esp.html"><a href="dep-esp.html#antes-de-continuar-dependencia-espacial."><i class="fa fa-check"></i><b>4.1</b> Antes de continuar… dependencia espacial.</a></li>
<li class="chapter" data-level="4.2" data-path="dep-esp.html"><a href="dep-esp.html#datos-espaciales"><i class="fa fa-check"></i><b>4.2</b> Datos espaciales</a></li>
<li class="chapter" data-level="4.3" data-path="dep-esp.html"><a href="dep-esp.html#clasificación-de-datos-espaciales"><i class="fa fa-check"></i><b>4.3</b> Clasificación de datos espaciales</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="caos.html"><a href="caos.html"><i class="fa fa-check"></i><b>5</b> Casos prácticos</a>
<ul>
<li class="chapter" data-level="5.1" data-path="caos.html"><a href="caos.html#caso-1-temperatura-mínimas-del-aire-en-españa."><i class="fa fa-check"></i><b>5.1</b> Caso 1: Temperatura mínimas del aire en España.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="appendix"><span><b>Anexo</b></span></li>
<li class="chapter" data-level="A" data-path="crsproy.html"><a href="crsproy.html"><i class="fa fa-check"></i><b>A</b> Tipos de CRS proyectados</a>
<ul>
<li class="chapter" data-level="A.1" data-path="crsproy.html"><a href="crsproy.html#por-tipo-de-superficie-de-proyección"><i class="fa fa-check"></i><b>A.1</b> Por tipo de superficie de proyección</a></li>
<li class="chapter" data-level="A.2" data-path="crsproy.html"><a href="crsproy.html#por-métrica-a-preservar"><i class="fa fa-check"></i><b>A.2</b> Por métrica a preservar</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="./">Máster en Data Science & Business Analytics (con R Software)</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Visualización y geolocalización de datos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="caos" class="section level1" number="5">
<h1><span class="header-section-number">Capítulo 5</span> Casos prácticos</h1>
<div class="infobox">
<p><strong>NOTA</strong></p>
<p>En las siguientes aplicaciones se asumen que los datos se localizan en la
carpeta <code>data</code> del proyecto de R-Studio en el que se esté trabajando.</p>
<p>Los datos pueden descargarse desde esta dirección:</p>
<p><a href="https://github.com/mdsr-espacial/datos/raw/main/01_visualizacion/datos.zip" class="uri">https://github.com/mdsr-espacial/datos/raw/main/01_visualizacion/datos.zip</a></p>
</div>
<div id="caso-1-temperatura-mínimas-del-aire-en-españa." class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Caso 1: Temperatura mínimas del aire en España.</h2>
<p><strong>Objetivo de aprendizaje</strong></p>
<p>Esta sección presenta un caso de uso en el que aprenderemos a realizar las
siguientes tareas básicas:</p>
<ol style="list-style-type: decimal">
<li><p>Leer datos espaciales en R.</p></li>
<li><p>Proyectar datos espaciales.</p></li>
<li><p>Graficar datos espaciales.</p></li>
</ol>
<p>Para ello, se va a trabajar con los datos de temperatura mínima registradas en
España por las estaciones metereológicas de la Agencia Estatal de Meteorología
(AEMET). Un conjuto de datos ya depurados y listos par trabajar se encuentra en
el fichero <code>tempmin.csv</code>. Por otra parte, la información relativa al mapeo de
España se obtendrá directamente de la librería <code>mapSpain</code>. Todo el análisis se
va a realizar empleando RStudio, por lo que se empezará abriendo el programa y
creando un nuevo proyecto.</p>
<div class="exercise">
<p><span id="exr:ex-crea" class="exercise"><strong>Ejercicio 5.1  (Creación del proyecto) </strong></span>Cree un proyecto para trabajar todo lo referente al caso.</p>
</div>
<div class="solution">
<p><span id="sol-crea" class="solution"><em>Solución</em>. </span>Para crear un proyecto siga la secuencia: <em>File&gt; New Proyect&gt; New File&gt; RMD</em></p>
</div>
<p>El conjunto de datos proporcionado <code>tempmin.csv</code> contiene el nivel de
temperatura del aire en España entre el 6 y el 10 de Enero de
2021<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. Estos datos han sido descargados usando la librería
<strong>climaemet</strong> <span class="citation">(<a href="#ref-R-climaemet" role="doc-biblioref">Pizarro, Hernangómez, and Fernández-Avilés 2021</a>)</span> y han sido posteriormente tratados para su uso en
esta práctica.</p>
<p>A continuación es necesario importar la base de datos de temperatura mínima. El
archivo está en formato csv, por lo cual, es un fichero de texto plano. Se
pueden usar varias funciones para realizar la importación. Se emplearán los
paquetes del <strong>tidyverse</strong> <span class="citation">(<a href="#ref-R-tidyverse" role="doc-biblioref">Wickham et al. 2019</a>)</span> para realizar todo el tratamiento de
datos.</p>
<div class="exercise">
<p><span id="exr:ex2" class="exercise"><strong>Ejercicio 5.2  (Importación de los datos) </strong></span>Importe los datos <code>tempmin.csv</code> y guárdelos en un objeto llamado <code>tmin</code>.</p>
</div>
<div class="solution">
<p><span id="sol2" class="solution"><em>Solución</em>. </span>Use la librería <strong>readr</strong>.</p>
</div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="caos.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cada uno debe seleccionar el directorio donde tiene los datos, de ahí</span></span>
<span id="cb22-2"><a href="caos.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># que sea conveniente trabajar con proyectos.</span></span>
<span id="cb22-3"><a href="caos.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb22-4"><a href="caos.html#cb22-4" aria-hidden="true" tabindex="-1"></a>tmin <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/tempmin.csv&quot;</span>)</span></code></pre></div>
<p>El conjunto de datos <code>tempmin</code> es un data frame que contiene 5 variables:</p>
<ul>
<li><p><code>fecha</code>: Indicando la fecha de observación.</p></li>
<li><p><code>indicativo</code>: Es el identificador de la estación de la AEMET que registró el
dato.</p></li>
<li><p><code>tmin</code>: Dato de temperatura mínima registrada en cada fecha por la estación
correspondiente en grados centígrados.</p></li>
<li><p><code>longitud, latitud</code>: Coordenadas geográficas de la estación</p></li>
</ul>
<div class="exercise">
<p><span id="exr:ex3" class="exercise"><strong>Ejercicio 5.3  (Descripción de los datos) </strong></span>Con la función <code>head()</code> describa, en forma de tabla, la información que contiene
el objeto <code>tmin</code> y compruebe que se corresponde con la descrita.</p>
</div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="caos.html#cb23-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(tmin), <span class="at">caption =</span> <span class="st">&quot;Detalle del objeto tmin&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:tmin-head">Tabla 5.1: </span>Detalle del objeto tmin</caption>
<thead>
<tr class="header">
<th align="left">fecha</th>
<th align="left">indicativo</th>
<th align="right">tmin</th>
<th align="right">longitud</th>
<th align="right">latitud</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2021-01-06</td>
<td align="left">4358X</td>
<td align="right">-4.7</td>
<td align="right">-5.880556</td>
<td align="right">38.95556</td>
</tr>
<tr class="even">
<td align="left">2021-01-06</td>
<td align="left">4220X</td>
<td align="right">-7.0</td>
<td align="right">-4.616389</td>
<td align="right">39.08861</td>
</tr>
<tr class="odd">
<td align="left">2021-01-06</td>
<td align="left">6106X</td>
<td align="right">4.7</td>
<td align="right">-4.748333</td>
<td align="right">37.02944</td>
</tr>
<tr class="even">
<td align="left">2021-01-06</td>
<td align="left">9698U</td>
<td align="right">-6.8</td>
<td align="right">0.865278</td>
<td align="right">42.20528</td>
</tr>
<tr class="odd">
<td align="left">2021-01-06</td>
<td align="left">4410X</td>
<td align="right">-3.4</td>
<td align="right">-6.385556</td>
<td align="right">38.91583</td>
</tr>
<tr class="even">
<td align="left">2021-01-06</td>
<td align="left">1331A</td>
<td align="right">1.0</td>
<td align="right">-7.031389</td>
<td align="right">43.52472</td>
</tr>
</tbody>
</table>
<p>Una de las clases de objetos espaciales más utilzada en R es <code>sf</code>. Sin embargo,
dependiendo del análisis que se quiera realizar hay otras muy comunes como
<code>geodata</code>, <code>spatastat</code>, etc..</p>
<p>A continuación se convertirá el objeto <code>tmin</code> (<code>data.frame</code>) a un objeto de la
clase <code>geodata</code>, una clase muy utilizada para trabajar con datos espaciales y
requerida por la librería <code>geoR</code> <span class="citation">(<a href="#ref-R-geor" role="doc-biblioref">Ribeiro Jr et al. 2020</a>)</span>. Estos objetos contienen las
coordenadas y la variable objeto de estudio. Para mayor detalle ver
<code>??as.geodata</code>. Obsérvese como varía la variable a través de los ejes longitud y
latitud. Observe tambien la forma campaniforme de la distribución de la
variable.</p>
<div class="exercise">
<p><span id="exr:ex4" class="exercise"><strong>Ejercicio 5.4  (Descripción de los datos) </strong></span>Del objeto <code>tmin</code> seleccione el día <strong>8 de enero de 2022</strong> y las variables
<code>longitud</code>, <code>latitud</code> y <code>tmin</code> para crear el objeto y llámelo <code>tmin_geoR</code>. A
continuación describa analítica y gráficamente dicho objeto.</p>
</div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="caos.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb24-2"><a href="caos.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geoR)</span>
<span id="cb24-3"><a href="caos.html#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="caos.html#cb24-4" aria-hidden="true" tabindex="-1"></a>tmin_geoR <span class="ot">&lt;-</span> tmin <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="caos.html#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fecha <span class="sc">==</span> <span class="st">&quot;2021-01-08&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="caos.html#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Seleccionamos las columnas de interés</span></span>
<span id="cb24-7"><a href="caos.html#cb24-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(longitud, latitud, tmin) <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="caos.html#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Y creamos el objeto geodata</span></span>
<span id="cb24-9"><a href="caos.html#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.geodata</span>(</span>
<span id="cb24-10"><a href="caos.html#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">coords.col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb24-11"><a href="caos.html#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">data.col =</span> <span class="dv">3</span></span>
<span id="cb24-12"><a href="caos.html#cb24-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-13"><a href="caos.html#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="caos.html#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="caos.html#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tmin_geoR)</span>
<span id="cb24-16"><a href="caos.html#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of data points: 211 </span></span>
<span id="cb24-17"><a href="caos.html#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb24-18"><a href="caos.html#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coordinates summary</span></span>
<span id="cb24-19"><a href="caos.html#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      longitud  latitud</span></span>
<span id="cb24-20"><a href="caos.html#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; min -9.291389 35.27639</span></span>
<span id="cb24-21"><a href="caos.html#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; max  4.215556 43.78611</span></span>
<span id="cb24-22"><a href="caos.html#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb24-23"><a href="caos.html#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Distance summary</span></span>
<span id="cb24-24"><a href="caos.html#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         min         max </span></span>
<span id="cb24-25"><a href="caos.html#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.01024389 13.85144264 </span></span>
<span id="cb24-26"><a href="caos.html#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb24-27"><a href="caos.html#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Data summary</span></span>
<span id="cb24-28"><a href="caos.html#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Min.     1st Qu.      Median        Mean     3rd Qu.        Max. </span></span>
<span id="cb24-29"><a href="caos.html#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -14.9000000  -4.6000000  -0.5000000  -0.6293839   3.5000000  13.6000000</span></span>
<span id="cb24-30"><a href="caos.html#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tmin_geoR)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="Visualización_geolocalización_datos_files/figure-html/unnamed-chunk-10-1.png" alt="Convertir `data.frame` a `geodata`" width="60%" />
<p class="caption">
Figura 5.1: Convertir <code>data.frame</code> a <code>geodata</code>
</p>
</div>
<p>En esta ocasión, convertiremos los datos de <code>tmin</code> en un objeto espacial <code>sf</code>,
es decir, datos espaciales de tipo vector.</p>
<p>Los datos de <code>tmin</code> contienen coordenadas geográficas longitud/latitud, así que
como se vió en la Sección <a href="formatos.html#CRS">3.3</a> el CRS a emplear ha de ser un CRS
geográfico. Usaremos el código <strong>EPSG:4326</strong>, que corresponde a coordenadas
geográficas y suele ser el habitual en este tipo de situaciones.</p>
<div class="exercise">
<p><span id="exr:ex5" class="exercise"><strong>Ejercicio 5.5  (Convertir data.frame a sf) </strong></span>Del objeto <code>tmin</code> seleccione las variables <code>longitud</code>, <code>latitud</code> y <code>tmin</code> para
crear el objeto sf y llámelo <code>tmin_sf</code>. A continuación describa el objeto
creado.</p>
</div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="caos.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb25-2"><a href="caos.html#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="caos.html#cb25-3" aria-hidden="true" tabindex="-1"></a>tmin_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(tmin,</span>
<span id="cb25-4"><a href="caos.html#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;longitud&quot;</span>, <span class="st">&quot;latitud&quot;</span>),</span>
<span id="cb25-5"><a href="caos.html#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">crs =</span> <span class="dv">4326</span></span>
<span id="cb25-6"><a href="caos.html#cb25-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-7"><a href="caos.html#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="caos.html#cb25-8" aria-hidden="true" tabindex="-1"></a>tmin_sf</span>
<span id="cb25-9"><a href="caos.html#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 1066 features and 3 fields</span></span>
<span id="cb25-10"><a href="caos.html#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geometry type: POINT</span></span>
<span id="cb25-11"><a href="caos.html#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb25-12"><a href="caos.html#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: -9.291389 ymin: 35.27639 xmax: 4.215556 ymax: 43.78611</span></span>
<span id="cb25-13"><a href="caos.html#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span id="cb25-14"><a href="caos.html#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1,066 x 4</span></span>
<span id="cb25-15"><a href="caos.html#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    fecha      indicativo  tmin             geometry</span></span>
<span id="cb25-16"><a href="caos.html#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  * &lt;date&gt;     &lt;chr&gt;      &lt;dbl&gt;          &lt;POINT [°]&gt;</span></span>
<span id="cb25-17"><a href="caos.html#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1 2021-01-06 4358X       -4.7 (-5.880556 38.95556)</span></span>
<span id="cb25-18"><a href="caos.html#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2 2021-01-06 4220X       -7   (-4.616389 39.08861)</span></span>
<span id="cb25-19"><a href="caos.html#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  3 2021-01-06 6106X        4.7 (-4.748333 37.02944)</span></span>
<span id="cb25-20"><a href="caos.html#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  4 2021-01-06 9698U       -6.8  (0.865278 42.20528)</span></span>
<span id="cb25-21"><a href="caos.html#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  5 2021-01-06 4410X       -3.4 (-6.385556 38.91583)</span></span>
<span id="cb25-22"><a href="caos.html#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  6 2021-01-06 1331A        1   (-7.031389 43.52472)</span></span>
<span id="cb25-23"><a href="caos.html#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  7 2021-01-06 1690A       -0.1 (-7.859722 42.32528)</span></span>
<span id="cb25-24"><a href="caos.html#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  8 2021-01-06 8489X       -8   (-0.255833 40.43333)</span></span>
<span id="cb25-25"><a href="caos.html#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  9 2021-01-06 8025         2    (-0.494167 38.3725)</span></span>
<span id="cb25-26"><a href="caos.html#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10 2021-01-06 9784P      -10       (0.224722 42.63)</span></span>
<span id="cb25-27"><a href="caos.html#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # ... with 1,056 more rows</span></span></code></pre></div>
<p>La siguiente tarea será representar las estaciones que monitorizan la
temperatura mínima en un mapa de España.</p>
<div class="exercise">
<p><span id="exr:ex6" class="exercise"><strong>Ejercicio 5.6  (Reprsentación espacial de la clase sf) </strong></span>Represente un mapa de España, con las Comunidades Autónomas de incluidas,
excepto las Islas Canarias (por simplicidad)</p>
</div>
<div class="solution">
<p><span id="sol6" class="solution"><em>Solución</em>. </span>Una opción es utilizar un paquete API que nos proporciona esta información en
formato <code>sf</code>, el paquete <strong>mapSpain</strong>.</p>
</div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="caos.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapSpain)</span>
<span id="cb26-2"><a href="caos.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sf object</span></span>
<span id="cb26-3"><a href="caos.html#cb26-3" aria-hidden="true" tabindex="-1"></a>esp <span class="ot">&lt;-</span> <span class="fu">esp_get_ccaa</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="caos.html#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># No vamos a usar Canarias en este análisis</span></span>
<span id="cb26-5"><a href="caos.html#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ine.ccaa.name <span class="sc">!=</span> <span class="st">&quot;Canarias&quot;</span>)</span>
<span id="cb26-6"><a href="caos.html#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="caos.html#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="caos.html#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(esp<span class="sc">$</span>geometry) <span class="co"># Dibujamos el mapa de España menos las Islas Canarias</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-12"></span>
<img src="Visualización_geolocalización_datos_files/figure-html/unnamed-chunk-12-1.png" alt="Mapa de España (Sin Canarias)" width="60%" />
<p class="caption">
Figura 5.2: Mapa de España (Sin Canarias)
</p>
</div>
<p>Como se comentó en la Sección <a href="formatos.html#CRS">3.3</a>, cuando se emplean datos geográficos
provenientes de varias fuentes, es necesario asegurarse de que ambos objetos
están usando el mismo CRS.</p>
<div class="exercise">
<p><span id="exr:ex7" class="exercise"><strong>Ejercicio 5.7  (CRS) </strong></span>¿Tengo el Sistema de referencia de coordenadas (CRS) de las estaciones de
monitoreo en la misma proyección que el contorno de España? Compruebelo.</p>
</div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="caos.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(tmin_sf) <span class="sc">==</span> <span class="fu">st_crs</span>(esp)</span>
<span id="cb27-2"><a href="caos.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>Se ha comprobado que no lo están, por lo que hay que proyectar las coordenadas a
un CRS común.</p>
<div class="exercise">
<p><span id="exr:ex8" class="exercise"><strong>Ejercicio 5.8  (CRS) </strong></span>Proyecte las coordenadas de los objetos <code>tmin_sf</code> y <code>esp</code> al CRS de referencia
de <code>tmin_sf</code>. Compruébelo.</p>
</div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="caos.html#cb28-1" aria-hidden="true" tabindex="-1"></a>esp2 <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(esp, <span class="fu">st_crs</span>(tmin_sf))</span>
<span id="cb28-2"><a href="caos.html#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="caos.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(tmin_sf) <span class="sc">==</span> <span class="fu">st_crs</span>(esp2)</span>
<span id="cb28-4"><a href="caos.html#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Para dibujar las estaciones de monitoreo con el contorno de España, existen
varias opciones de paquetes, <strong>ggplot2</strong> <span class="citation">(<a href="#ref-R-ggplot" role="doc-biblioref">Wickham 2016</a>)</span> (paquete de referencia en
representaciones gráficas), <strong>tmap</strong> <span class="citation">(<a href="#ref-R-tmap" role="doc-biblioref">Tennekes 2018</a>)</span> o <strong>mapsf</strong> <span class="citation">(<a href="#ref-R-mapsf" role="doc-biblioref">Giraud 2022</a>)</span> (estos dos
últimos especializados en mapas temáticos).</p>
<div class="exercise">
<p><span id="exr:ex9" class="exercise"><strong>Ejercicio 5.9  (CRS) </strong></span>Represente, con el paquete <strong>ggplot2</strong>, las estaciones de monitorero de AEMET en
la Península Ibérica.</p>
</div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="caos.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb29-2"><a href="caos.html#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="caos.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(esp2) <span class="sc">+</span></span>
<span id="cb29-4"><a href="caos.html#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Para graficar objetos sf debemos usar geom_sf()</span></span>
<span id="cb29-5"><a href="caos.html#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb29-6"><a href="caos.html#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> tmin_sf) <span class="sc">+</span></span>
<span id="cb29-7"><a href="caos.html#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb29-8"><a href="caos.html#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labs(</span></span>
<span id="cb29-9"><a href="caos.html#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  title = &quot;Estaciones de monitoreo AEMET en  España&quot;,</span></span>
<span id="cb29-10"><a href="caos.html#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  subtitle = &quot;excluyendo las Islas Canarias&quot;</span></span>
<span id="cb29-11"><a href="caos.html#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ) +</span></span>
<span id="cb29-12"><a href="caos.html#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb29-13"><a href="caos.html#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(</span>
<span id="cb29-14"><a href="caos.html#cb29-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">12</span>,</span>
<span id="cb29-15"><a href="caos.html#cb29-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">face =</span> <span class="st">&quot;bold&quot;</span></span>
<span id="cb29-16"><a href="caos.html#cb29-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-17"><a href="caos.html#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(</span>
<span id="cb29-18"><a href="caos.html#cb29-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> <span class="dv">8</span>,</span>
<span id="cb29-19"><a href="caos.html#cb29-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">face =</span> <span class="st">&quot;italic&quot;</span></span>
<span id="cb29-20"><a href="caos.html#cb29-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-21"><a href="caos.html#cb29-21" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-14"></span>
<img src="Visualización_geolocalización_datos_files/figure-html/unnamed-chunk-14-1.png" alt="Estaciones de AEMET en la Península Ibérica" width="60%" />
<p class="caption">
Figura 5.3: Estaciones de AEMET en la Península Ibérica
</p>
</div>
<p>Una vez represtadas las coordenadas, es decir, las estaciones de monitoreo dónde
se ha medido la variable temperatura mínima <code>tmin</code>, el siguiente paso será
representar el valor que toma la variable en esas coodenadas. La base <code>tmin</code>
contiene información temporal para para varios días, por lo que, como este
análisis es meramente espacial se elegirá un día que se fijará para todo el
análisis.</p>
<div class="exercise">
<p><span id="exr:ex10" class="exercise"><strong>Ejercicio 5.10  (plot-sp1) </strong></span>Representamos la variable temperatura mínima <code>tmin</code> para el día <strong>8 de enero de
2021</strong>. Guarde la base de datos espacial para ese día en un objeto de nombre
<code>tmin_8enero</code>.</p>
</div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="caos.html#cb30-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-2"><a href="caos.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionaremos los datos correspondientes al 8 de enero de 2021</span></span>
<span id="cb30-3"><a href="caos.html#cb30-3" aria-hidden="true" tabindex="-1"></a>tmin_8enero <span class="ot">&lt;-</span> tmin_sf <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="caos.html#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(fecha <span class="sc">==</span> <span class="st">&quot;2021-01-08&quot;</span>)</span>
<span id="cb30-5"><a href="caos.html#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="caos.html#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="caos.html#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Mapa temático en el que se representan los valores de temperatura mínima</span></span>
<span id="cb30-8"><a href="caos.html#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># registrados en cada estación mediante un código de colores</span></span>
<span id="cb30-9"><a href="caos.html#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tmin_8enero[<span class="st">&quot;tmin&quot;</span>],</span>
<span id="cb30-10"><a href="caos.html#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># main = &quot;Temperatura mínima (8-enero-2021)&quot;,</span></span>
<span id="cb30-11"><a href="caos.html#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">8</span></span>
<span id="cb30-12"><a href="caos.html#cb30-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:plot-base-tmin"></span>
<img src="Visualización_geolocalización_datos_files/figure-html/plot-base-tmin-1.png" alt="Mapa de puntos con temperatura mínima (8-enero-2021)" width="60%" />
<p class="caption">
Figura 5.4: Mapa de puntos con temperatura mínima (8-enero-2021)
</p>
</div>
<p>El mapa ha quedado muy bien, pero quizá los colores y el formato elegido no sean
los más adecuados para este tipo de representaciones…</p>
<div class="exercise">
<p><span id="exr:unlabeled-div-1" class="exercise"><strong>Ejercicio 5.11  (plot-sp2) </strong></span>Utilice los parámetros espaciales de los que dispone, las coordenadas y el
contorno de España para graficar y contar la historia de <strong>Filomena</strong>
adecuadamente.</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:spatial-plots"></span>
<img src="Visualización_geolocalización_datos_files/figure-html/spatial-plots-1.png" alt="Mapa completo con temperatura mínima (8-enero-2021)" width="60%" />
<p class="caption">
Figura 5.5: Mapa completo con temperatura mínima (8-enero-2021)
</p>
</div>
<p>La visión que ofrece el la Fig. <a href="caos.html#fig:spatial-plots">5.5</a> de Filomena es muy
informativa, vemos como los datos nos cuentan la historia de lo que ocurrió ese
día. La pena es que no existan estaciones de monitoreo en todos los puntos de
España para conocer el valor de la temperatura mínima en cualquier lugar del
país. ¿Podríamos tener un mapa de interpolación para tener una estimación de la
temperatura mínima en las partes donde la AEMET no tiene estación de monitoreo?</p>
<p>Tal y como se avanzó en el Capítulo <a href="dep-esp.html#dep-esp">4</a>, parece lógico pensar que
aquellos puntos que estén cerca tendrán valores similares. Por tanto, tomemos
ventaja de las propiedades de la dependencia espacial y utilicemos un método de
interpolación sencillo, en este caso un método determinista, la Distancia
Inversa Ponderada, comúnmente conocido por su acrónimo inglés IDW (Inverse
distance weighted), el cual es uno de los métodos más simples para llevar para
llevar a cabo una interpolación espacial.</p>
<p>En este tipo de análisis espacial, es crucial que el CRS sea el apropiado. En
este caso, ya se definió el CRS como un CRS geográfico (es decir, usando
coordenadas de longitud y latitud). Sin embargo, para el ejercicio de
interpolación es más adecuado usar un CRS local (que provoca pocas deformaciones
en la proyección de España) y en alguna unidad de distancia, como metros (ya se
vio en la Sección <a href="formatos.html#CRS">3.3</a> que en los CRS geográficos las unidades son
grados).</p>
<div class="exercise">
<p><span id="exr:ex11" class="exercise"><strong>Ejercicio 5.12  (Obtención de CRS sugerido para un conjuto de datos) </strong></span>Utilice el paquete <strong>crsuggest</strong> para observar los CRS sugeridos y, si es
necesario, transforme la proyección de los datos.</p>
</div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="caos.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(crsuggest)</span>
<span id="cb31-2"><a href="caos.html#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="caos.html#cb31-3" aria-hidden="true" tabindex="-1"></a>sugiere <span class="ot">&lt;-</span> <span class="fu">suggest_crs</span>(tmin_8enero, <span class="at">units =</span> <span class="st">&quot;m&quot;</span>, <span class="at">limit =</span> <span class="dv">5</span>)</span>
<span id="cb31-4"><a href="caos.html#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="caos.html#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Usamos la sugerencia del paquete</span></span>
<span id="cb31-6"><a href="caos.html#cb31-6" aria-hidden="true" tabindex="-1"></a>crs_sugerido <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(sugiere[<span class="dv">1</span>, ]<span class="sc">$</span>crs_proj4) <span class="co"># Madrid</span></span>
<span id="cb31-7"><a href="caos.html#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="caos.html#cb31-8" aria-hidden="true" tabindex="-1"></a>esp3 <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(esp2, crs_sugerido)</span>
<span id="cb31-9"><a href="caos.html#cb31-9" aria-hidden="true" tabindex="-1"></a>tmin_8enero3 <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(tmin_8enero, crs_sugerido)</span></code></pre></div>
<p>Una vez solucionado el problema de las proyecciones, antes de llevar a cabo la
interpolación, es necesario generar una malla que representará las celdas de las
que queremos obtener el valor interpolado. Dado que hemos proyectado nuestros
datos a un CRS cuya unidad son los metros, podemos definir el tamaño de cada
celda en metros cuadrados. En este caso vamos a usar celdas de 100 kms cuadrados
(10 x 10 kms).</p>
<div class="exercise">
<p><span id="exr:ex12" class="exercise"><strong>Ejercicio 5.13  (Creación y representación de una malla de interpolación) </strong></span>Genere un grid y llámelo <code>malla_sf</code> (puede fijar una semilla si lo desea) y
grafíque la superficie construida.</p>
</div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="caos.html#cb32-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-2"><a href="caos.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Generación de la superficie a interpolar</span></span>
<span id="cb32-3"><a href="caos.html#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9876</span>) <span class="co"># Aseguramos que el grid generado siempre es igual</span></span>
<span id="cb32-4"><a href="caos.html#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="caos.html#cb32-5" aria-hidden="true" tabindex="-1"></a>malla_sf <span class="ot">&lt;-</span> <span class="fu">st_make_grid</span>(</span>
<span id="cb32-6"><a href="caos.html#cb32-6" aria-hidden="true" tabindex="-1"></a>  esp3,</span>
<span id="cb32-7"><a href="caos.html#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cellsize =</span> <span class="dv">10000</span></span>
<span id="cb32-8"><a href="caos.html#cb32-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-9"><a href="caos.html#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="caos.html#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Representación de la superficie construida añadiendo el contorno de España</span></span>
<span id="cb32-11"><a href="caos.html#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(esp3) <span class="sc">+</span></span>
<span id="cb32-12"><a href="caos.html#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb32-13"><a href="caos.html#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(</span>
<span id="cb32-14"><a href="caos.html#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> malla_sf,</span>
<span id="cb32-15"><a href="caos.html#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.1</span>,</span>
<span id="cb32-16"><a href="caos.html#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="cb32-17"><a href="caos.html#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="cn">NA</span></span>
<span id="cb32-18"><a href="caos.html#cb32-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb32-19"><a href="caos.html#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(</span>
<span id="cb32-20"><a href="caos.html#cb32-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> tmin_8enero3,</span>
<span id="cb32-21"><a href="caos.html#cb32-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">&quot;AEMET Stations&quot;</span>), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb32-22"><a href="caos.html#cb32-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb32-23"><a href="caos.html#cb32-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb32-24"><a href="caos.html#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;blue&quot;</span>, <span class="at">alpha.f =</span> <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb32-25"><a href="caos.html#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb32-26"><a href="caos.html#cb32-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:create-grid2"></span>
<img src="Visualización_geolocalización_datos_files/figure-html/create-grid2-1.png" alt="Malla de puntos para interpolación" width="60%" />
<p class="caption">
Figura 5.6: Malla de puntos para interpolación
</p>
</div>
<p>Se puede observar claramente cada una de las celdas que se han creado. La
interpolación asignará un valor a cada uno de ellas.</p>
<p>A continuación podemos llevar a cabo la interpolación usando el paquete
<strong>gstat</strong> <span class="citation">(<a href="#ref-R-gstat" role="doc-biblioref">Pebesma 2004</a>)</span>. Además, en lugar de celdas (polígonos) es necesario usar
puntos en la interpolación. Calcularemos, por tanto, un punto representativo de
cada celda creada en la superficie anterior <code>malla_sf</code>, el centroide, que es el
punto resultante de realizar la media arimética de las coordenadas de los puntos
que componen los lados de cada celda.</p>
<div class="exercise">
<p><span id="exr:ex13" class="exercise"><strong>Ejercicio 5.14  (Interpolación a través de la Distancia Inversa Ponderada) </strong></span>Calcule los centroides de los polígonos de la malla construida en el Ejercicio
<a href="caos.html#exr:ex12">5.13</a> con la función <code>st_centroid()</code> y realice una interpolación de la
variable temperatura mínima <code>tmin</code> para el día 8 de enero de 2021 con el método
IDW usando la librería <strong>gstat</strong> y la función <code>idw</code>. Guarde el resultado
obtenido en un objeto llamado <code>tmin_idw</code>. Utilice la función <code>help(idw)</code> si
requiere información sobre cómo introducir los parámetros en la función.</p>
<p>Examine la información del objeto <code>tmin_idw</code>, a través de la función <code>head()</code>,</p>
</div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="caos.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculamos una malla con centroides</span></span>
<span id="cb33-2"><a href="caos.html#cb33-2" aria-hidden="true" tabindex="-1"></a>malla_sf_cent <span class="ot">&lt;-</span> <span class="fu">st_centroid</span>(malla_sf, <span class="at">of_largest_polygon =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-3"><a href="caos.html#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="caos.html#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gstat)</span>
<span id="cb33-5"><a href="caos.html#cb33-5" aria-hidden="true" tabindex="-1"></a>tmin_idw <span class="ot">&lt;-</span> <span class="fu">idw</span>(</span>
<span id="cb33-6"><a href="caos.html#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Indicamos la variable que queremos interpolar</span></span>
<span id="cb33-7"><a href="caos.html#cb33-7" aria-hidden="true" tabindex="-1"></a>  tmin <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb33-8"><a href="caos.html#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Indicamos el conjunto de datos donde está la variable</span></span>
<span id="cb33-9"><a href="caos.html#cb33-9" aria-hidden="true" tabindex="-1"></a>  tmin_8enero3,</span>
<span id="cb33-10"><a href="caos.html#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Indicamos la malla de destino, en sf</span></span>
<span id="cb33-11"><a href="caos.html#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> malla_sf_cent,</span>
<span id="cb33-12"><a href="caos.html#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">idp =</span> <span class="fl">2.0</span> <span class="co"># Especifica la potencia de la IDW</span></span>
<span id="cb33-13"><a href="caos.html#cb33-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-14"><a href="caos.html#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [inverse distance weighted interpolation]</span></span>
<span id="cb33-15"><a href="caos.html#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tmin_idw)</span>
<span id="cb33-16"><a href="caos.html#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Simple feature collection with 6 features and 2 fields</span></span>
<span id="cb33-17"><a href="caos.html#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Geometry type: POINT</span></span>
<span id="cb33-18"><a href="caos.html#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Dimension:     XY</span></span>
<span id="cb33-19"><a href="caos.html#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bounding box:  xmin: 147290.9 ymin: 70457.31 xmax: 197290.9 ymax: 70457.31</span></span>
<span id="cb33-20"><a href="caos.html#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CRS:           +proj=lcc +lat_1=40 +lat_0=40 +lon_0=0 +k_0=0.9988085293 +x_0=600000 +y_0=600000 +a=6378298.3 +rf=294.73 +pm=madrid +units=m +no_defs</span></span>
<span id="cb33-21"><a href="caos.html#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   var1.pred var1.var                  geometry</span></span>
<span id="cb33-22"><a href="caos.html#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1  2.529082       NA POINT (147290.9 70457.31)</span></span>
<span id="cb33-23"><a href="caos.html#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  2.615255       NA POINT (157290.9 70457.31)</span></span>
<span id="cb33-24"><a href="caos.html#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3  2.703976       NA POINT (167290.9 70457.31)</span></span>
<span id="cb33-25"><a href="caos.html#cb33-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4  2.795295       NA POINT (177290.9 70457.31)</span></span>
<span id="cb33-26"><a href="caos.html#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5  2.889262       NA POINT (187290.9 70457.31)</span></span>
<span id="cb33-27"><a href="caos.html#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6  2.985925       NA POINT (197290.9 70457.31)</span></span></code></pre></div>
<p>Un tipo de mapas muy utilizado cuando se trabaja con datos espaciales son los
mapas de contorno. Es muy visual y ayuda a interpretar el mapa interpolado,
añadir unas lineas de contorno al mapa interpolado.</p>
<div class="exercise">
<p><span id="exr:ex14" class="exercise"><strong>Ejercicio 5.15  (Mapa de interpolación y contorno con raster) </strong></span>Represente los valores interpolados, <code>tmin_idw</code>, y añada unas lineas de
contorno. Utilice el paquete <strong>raster</strong> para convertir el objeto interpolado a
pixeles.</p>
</div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="caos.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertimos de sf a SpatiaPixels</span></span>
<span id="cb34-2"><a href="caos.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Esto funciona porque nuestros puntos sf están espaciados regularmente</span></span>
<span id="cb34-3"><a href="caos.html#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="caos.html#cb34-4" aria-hidden="true" tabindex="-1"></a>tmin_pixels <span class="ot">&lt;-</span> tmin_idw <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="caos.html#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as</span>(<span class="st">&quot;Spatial&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="caos.html#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as</span>(<span class="st">&quot;SpatialPixels&quot;</span>)</span>
<span id="cb34-7"><a href="caos.html#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="caos.html#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="caos.html#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb34-10"><a href="caos.html#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos un raster de nuestros pixels</span></span>
<span id="cb34-11"><a href="caos.html#cb34-11" aria-hidden="true" tabindex="-1"></a>rast_esp <span class="ot">&lt;-</span> <span class="fu">raster</span>(tmin_pixels)</span>
<span id="cb34-12"><a href="caos.html#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="caos.html#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Transferimos valores del objeto sf al raster</span></span>
<span id="cb34-14"><a href="caos.html#cb34-14" aria-hidden="true" tabindex="-1"></a>rast_esp2 <span class="ot">&lt;-</span> <span class="fu">rasterize</span>(</span>
<span id="cb34-15"><a href="caos.html#cb34-15" aria-hidden="true" tabindex="-1"></a>  tmin_idw,</span>
<span id="cb34-16"><a href="caos.html#cb34-16" aria-hidden="true" tabindex="-1"></a>  rast_esp,</span>
<span id="cb34-17"><a href="caos.html#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">field =</span> <span class="st">&quot;var1.pred&quot;</span>, <span class="do">## valores de predicción idw</span></span>
<span id="cb34-18"><a href="caos.html#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> mean</span>
<span id="cb34-19"><a href="caos.html#cb34-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-20"><a href="caos.html#cb34-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-21"><a href="caos.html#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Además, podemos recortar el raster a la forma de España</span></span>
<span id="cb34-22"><a href="caos.html#cb34-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-23"><a href="caos.html#cb34-23" aria-hidden="true" tabindex="-1"></a>rast_esp_mask <span class="ot">&lt;-</span> <span class="fu">mask</span>(rast_esp2, esp3)</span>
<span id="cb34-24"><a href="caos.html#cb34-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-25"><a href="caos.html#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rast_esp_mask, <span class="at">col =</span> colores)</span>
<span id="cb34-26"><a href="caos.html#cb34-26" aria-hidden="true" tabindex="-1"></a><span class="fu">contour</span>(rast_esp2, <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-17"></span>
<img src="Visualización_geolocalización_datos_files/figure-html/unnamed-chunk-17-1.png" alt="Mapa raster con lineas de nivel" width="60%" />
<p class="caption">
Figura 5.7: Mapa raster con lineas de nivel
</p>
</div>
<div class="exercise">
<p><span id="exr:ex15" class="exercise"><strong>Ejercicio 5.16  (Mapa de interpolación con `ggplot`) </strong></span>Repita el mapa de <a href="caos.html#exr:ex14">5.15</a> usando <strong>ggplot2</strong> y la función
<code>geom_contour_filled()</code>.</p>
</div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="caos.html#cb35-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2"><a href="caos.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Creo una tabla para geom contour</span></span>
<span id="cb35-3"><a href="caos.html#cb35-3" aria-hidden="true" tabindex="-1"></a>coordenadas <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(tmin_idw)</span>
<span id="cb35-4"><a href="caos.html#cb35-4" aria-hidden="true" tabindex="-1"></a>valor <span class="ot">&lt;-</span> tmin_idw<span class="sc">$</span>var1.pred</span>
<span id="cb35-5"><a href="caos.html#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="caos.html#cb35-6" aria-hidden="true" tabindex="-1"></a>idw_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-7"><a href="caos.html#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Necesitamos redondear las coordenadas</span></span>
<span id="cb35-8"><a href="caos.html#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">latitud =</span> <span class="fu">round</span>(coordenadas[, <span class="dv">2</span>], <span class="dv">6</span>),</span>
<span id="cb35-9"><a href="caos.html#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">longitud =</span> <span class="fu">round</span>(coordenadas[, <span class="dv">1</span>], <span class="dv">6</span>),</span>
<span id="cb35-10"><a href="caos.html#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">tmin =</span> valor</span>
<span id="cb35-11"><a href="caos.html#cb35-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-12"><a href="caos.html#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="caos.html#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb35-14"><a href="caos.html#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>(</span>
<span id="cb35-15"><a href="caos.html#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> idw_df,</span>
<span id="cb35-16"><a href="caos.html#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> longitud, <span class="at">y =</span> latitud, <span class="at">z =</span> tmin),</span>
<span id="cb35-17"><a href="caos.html#cb35-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-18"><a href="caos.html#cb35-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> cortes</span>
<span id="cb35-19"><a href="caos.html#cb35-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-20"><a href="caos.html#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reajustamos la escala de colores</span></span>
<span id="cb35-21"><a href="caos.html#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> colores) <span class="sc">+</span></span>
<span id="cb35-22"><a href="caos.html#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># CCAA</span></span>
<span id="cb35-23"><a href="caos.html#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> esp3, <span class="at">fill =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb35-24"><a href="caos.html#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-25"><a href="caos.html#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb35-26"><a href="caos.html#cb35-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb35-27"><a href="caos.html#cb35-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;Temp. (º)&quot;</span></span>
<span id="cb35-28"><a href="caos.html#cb35-28" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-18"></span>
<img src="Visualización_geolocalización_datos_files/figure-html/unnamed-chunk-18-1.png" alt="Temperatura mínima interpolada. 8 de Enero 2021. " width="60%" />
<p class="caption">
Figura 5.8: Temperatura mínima interpolada. 8 de Enero 2021.
</p>
</div>

</div>
</div>
<h3>Referencias</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-R-mapsf" class="csl-entry">
Giraud, Timothée. 2022. <em><span class="nocase">mapsf</span>: Thematic Cartography</em>. <a href="https://CRAN.R-project.org/package=mapsf">https://CRAN.R-project.org/package=mapsf</a>.
</div>
<div id="ref-R-gstat" class="csl-entry">
Pebesma, Edzer. 2004. <span>“Multivariable Geostatistics in <span>S</span>: The <span class="nocase">gstat</span> Package.”</span> <em>Computers &amp; Geosciences</em> 30: 683–91.
</div>
<div id="ref-R-climaemet" class="csl-entry">
Pizarro, Manuel, Diego Hernangómez, and Gema Fernández-Avilés. 2021. <em><span class="nocase">climaemet</span>: Climate <span>AEMET</span> Tools</em>. <a href="https://doi.org/10.5281/zenodo.5205573">https://doi.org/10.5281/zenodo.5205573</a>.
</div>
<div id="ref-R-geor" class="csl-entry">
Ribeiro Jr, Paulo J., Peter J. Diggle, Martin Schlather, Roger Bivand, and Brian Ripley. 2020. <em><span class="nocase">geoR</span>: Analysis of Geostatistical Data</em>. <a href="https://CRAN.R-project.org/package=geoR">https://CRAN.R-project.org/package=geoR</a>.
</div>
<div id="ref-R-tmap" class="csl-entry">
Tennekes, Martijn. 2018. <span>“<span class="nocase">tmap</span>: Thematic Maps in <span>R</span>.”</span> <em>Journal of Statistical Software</em> 84 (6): 1–39. <a href="https://doi.org/10.18637/jss.v084.i06">https://doi.org/10.18637/jss.v084.i06</a>.
</div>
<div id="ref-R-ggplot" class="csl-entry">
Wickham, Hadley. 2016. <em><span class="nocase">ggplot2</span>: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-R-tidyverse" class="csl-entry">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“Welcome to the <span class="nocase">tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Las fechas seleccionadas coinciden con el periodo en el
que la tormenta Filomena tuvo su auge en la Península Ibérica.<a href="caos.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dep-esp.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="referencias.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Visualización_geolocalización_datos.pdf", "Visualización_geolocalización_datos.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
