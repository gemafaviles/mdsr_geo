[["index.html", "Visualización y geolocalización de datos Introducción", " Visualización y geolocalización de datos Gema Fernández-Avilés Diego Hernangómez 2022-01-27 Introducción Objetivos de aprendizaje ¿Por dónde empezamos? Recursos interesantes Libros de referencia: Spatial Data Science with applications in R Geocomputation with R Displaying time series, spatial and space-time data with R Recursos de estadística espacial en R: rspatial R-spatial "],["la-revolución-de-los-geodatos.html", "Capítulo 1 La revolución de los geodatos", " Capítulo 1 La revolución de los geodatos Que estamos en la la era del dato, que los datos son el petróleo del siglo XXI y que estamos rodeados de datos es una cuestión que ya hemos hecho inherente a nosotros. Vivimos en el momento del dato, donde la profesión de Data Scientist se ha convertido en la profesión más sexy del siglo XXI según vaticinó en 2012 Harvard Business Review. Cada segundo se producen 1,7 MB de datos/persona y cada año esta cifra se duplica se duplica. Este incremento exponencial de los datos ha sido posible, sin duda, gracias al desarrollo de la tecnología, la informática, los ordenadores, los teléfonos móviles, los satélites, internet, etc y asociado a estas nuevas herramientas, se ha producido una lluvia sin precedentes hasta el momento de datos espaciales o datos georreferenciados. Cada teléfono inteligente tiene un Receptor de posicionamiento Global (en inglés, Global Positioning System, GPS) y, además, convivimos con una multitud de sensores en dispositivos que van desde satélites y vehículos semi-autónomos hasta científicos ciudadanos que miden incesantemente cada parte del mundo. La tasa de datos producidos es abrumadora. Un vehículo autónomo, por ejemplo, puede generar 100 GB de datos por día (The Economist, 2016). Esta revolución de los geodatos y el análisis de los datos espaciales junto con los Sistemas de Información Geográficos (habitualmente expresados como GIS por las siglas de su nombre en inglés Geographical Information System) no sólo han impulsado la demanda de hardware informático de alto rendimiento y software escalable y eficiente para manejar y extraer la información, lo que se conoce como Geocomputación, sino que han dado lugar una nueva rama de conocimiento, Ciencia de Datos Espaciales comúnmente conocida como Spatial Data Scicene (SDS). Como ejemplo de este abrumador desarrollo de datos georreferenciados, el Ministerio de Transportes, Movilidad y Agenda Urbana llevó a cabo durante los años 2020 y 2021 el denominado Estudio de movilidad con Big Data, cuya fuente principal de datos fue el posicionamiento de los teléfonos móviles anonimizado. Estos datos permiten, por ejemplo, analizar la movilidad entre diversas zonas del territorio español de manera diaria (véase la Fig. 1.1). Este tipo de análisis era impensable hace tan solo unos años. Figura 1.1: Análisis de movilidad COVID "],["datos-geográficos.html", "Capítulo 2 Datos geográficos 2.1 Contexto general 2.2 Conceptos clave", " Capítulo 2 Datos geográficos 2.1 Contexto general La palabra geográfico puede dividirse en geo (tierra) + gráfico (dibujo/mapa). Por tanto, los datos geográficos contienen información de cualquier variable referenciada en un punto/área de la superficie terrestre y pueden representarse en mapas. El desarrollo de los datos geográficos ha producido grandes bases de datos espaciales y, a su vez, ha propiciado el desarrollo de herramientas para su tratamiento como los ya mencionados Sistemas de información geográficos y la Geocomputación. ¿Qué hace un Sistemas de información geográfico? Un Sistema de información geográfica (SIG) es una herramienta que crea, administra, analiza y mapea todo tipo de datos. GIS conecta datos a un mapa, integrando datos de ubicación (dónde están las cosas) con todo tipo de información descriptiva (cómo son las cosas allí). Esto proporciona una base para el mapeo y el análisis que se utiliza en la ciencia y en casi todas las industrias. GIS ayuda a los usuarios a comprender patrones, relaciones y contexto geográfico. Los beneficios incluyen una mejor comunicación y eficiencia, así como una mejor gestión y toma de decisiones. La Fig. 2.1 muestra el flujo de trabajo de los SIG, que va desde (i) la elaboración de mapas, (ii) la obtención de geodatos o datos espaciales, (iii) el análisis de los datos geográficamente referenciados y (iv) la edición, mapeo y presentación de los resultados. Figura 2.1: Flujo de trabajo de los GIS. Fuente: https://www.esri.com/en-us/what-is-gis/overview Pero es más, el desarrollo de la Inteligencia Artificial y la Inteligencia computacional se han convertido en herramientas creativas y complementarias a los convencionales GIS, dando origen a la Geocomputación, que trata de utilizar el poder de los ordenadores para hacer cosas con los datos geográficos. ¿Y que es la Geocomputación? En primer lugar, señalar que, aunque la geocomputación es un término relativamente nuevo se encuentra influenciado por otros términos clásicos. De manera sencilla puede definirse como el proceso de aplicar tecnologías de computación a problemas geográficos (Rees, 1998). Abrahart, Openshaw, Abrahart, &amp; See (2000) aporta más elementos formales a esta definición destacando que la geocomputación trata sobre los diferentes tipos de geodatos, y sobre el desarrollo de geo-herramientas relevantes en un contexto científico. La geocomputación está muy relacionada con otros términos como los SIG, ya definidos, y con diversos tipos de campos científicos, como las Geociencias, las Ciencias atmosféricas y climáticas, la Geoinformática, la Topología, la Ecología y las Ciencia de datos geográficos (GDS, Geographic Data Science). Cada término comparte un énfasis en un enfoque científico (que implica reproducible y falsable) influenciado por los GIS, aunque sus orígenes y principales campos de aplicación difieren. La geocomputación es ámpliamente utilizada en ámbitos como la sociología, el análisis político o el desarrollo de aplicaciones para móviles. Por tanto, usamos geocomputación como un sinónimo aproximado que encapsula a todas las ciencias que buscan usar datos geográficos para trabajos científicos aplicados. ¿Por que R para datos geográficos? R es una herramienta con capacidades avanzadas de análisis, modelado y visualización. Por ejemplo, los nuevos entornos de desarrollo integrado (en inglés, Integrated Development Environment, IDE), como RStudio, han hecho que R sea más fácil de usar para muchos, facilitando la creación de mapas con un panel dedicado a la visualización interactiva (Lovelace, Nowosad, &amp; Muenchow, 2019). Además, el uso del código R permite la enseñanza de la geocomputación con referencia a ejemplos reproducibles en lugar de conceptos abstractos. Por ejemplo, de una forma relativamente sencialla, se puede geoposicionar de manera interactiva la localización de la Puerta del Sol en Madrid y, además, dejar la el código R para hacerlo reproducible, ver Fig. 2.2. library(leaflet) leaflet(width = &quot;100%&quot;, height = &quot;500px&quot;) %&gt;% addTiles() %&gt;% setView(-3.703548, 40.417147, zoom = 60) Figura 2.2: Localización interactiva de la Puerta del Sol en Madrid Por otra parte R dispone de cientos de librerías especializadas para datos espaciales. Una descripción detallada puede ver se en CRAN Task View: Analysis of Spatial Data Para no abrumar al lector, a continuación se muestran, de manera esquemática, las librerías más usadas para el tratamiento de datos espaciales y que se emplearán a lo largo de la asignatura Estadística Espacial y Espacio-Temporal, no sólo en el tema que nos ocupa: sp y sf: para el tratamiento de clases y métodos de los datos vectoriales. raster,terra y stars para datos raster. gstat y geoR: para el análisis de datos geoestadísticos, ajuste y estimación de semivariogramas, interpolación, etc. spdep para el análisis de datos con modelos de econometría espacial, creación de matrices de contiguidad/distancia W, estimación de modelos econométricos espaciales, etc spatstat para el análisis de procesos de puntos espaciales, intensidad, etc. 2.2 Conceptos clave Una vez visto el contexto actual de los datos georreferenciados y antes de entrar en detalle en su análisis, debemos tener en cuenta una serie de conceptos clave que se irán desarrollando a lo largo del tema. Hemos dicho que Geográfico = Geo (tierra) + gráfico (mapa). Por tanto, si tenemos varios datos geográficos, localizados en distintos puntos de la tierra, es porque tenemos las coordenadas que los posicionan en esos puntos concretos. Asociado a estas coordenadas debemos conocer el Sistema de referencia de espacial o Coordinate reference system (CRS) en el que están proyectadas dichas coordenadas. Por otra parte, los formatos de estos datos pueden ser vectores o raster como se explicará en la Sección 3. Si damos un paso más e incorporamos el concepto de distancia, pues es lógico pensar que en un fenómeno de interés, por ejemplo, la modelización de la cantidad y dirección de lava en La Palma tras la erupción del volcán Cumbre Vieja, la distancia es un factor clave, pues aquellas zonas más cercanas al volcán tendrán niveles más parecidos entre sí y con valores más altos que aquellas que están más alejadas En este caso el nivel de contaminación en el aire en La Palma no puede ser modelado como si las observaciones fuesen independientes pues las más cercanas entre sí serán más parecidas que las más lejanas, dando lugar al concepto de dependencia espacial. Y depende del tipo de datos espaciales tendremos tres grandes formas de abordar el tratamiento de los datos espaciales: geoestadística, procesos de punto y econometría espacial (véase sección 3.4). Figura 2.3: Información espacial de la concentración de lava en Cumbre Vieja References Abrahart, R. J., Openshaw, S., Abrahart, R. J., &amp; See, L. M. (Eds.). (2000). Geocomputation. CRC Press. https://doi.org/10.4324/9780203305805 Lovelace, R., Nowosad, J., &amp; Muenchow, J. (2019). Geocomputation with R. CRC Press. Rees, I., P y Turton. (1998). Guest Editorial. Environment and Planning A: Economy and Space, 30(10), 18351838. https://doi.org/10.1068/a301835 "],["formatos.html", "Capítulo 3 Formatos de datos espaciales 3.1 Tipos de ficheros (COMPLETAR) 3.2 Datos de vectores 3.3 Datos raster 3.4 Sistema de Referencia de Coordenadas (CRS)", " Capítulo 3 Formatos de datos espaciales 3.1 Tipos de ficheros (COMPLETAR) Poner el esquema de los Shapes. https://en.wikipedia.org/wiki/Shapefile Yo no sé, DIEGO, si en gisco R tienes la definición y lo ponemos de ahí. Y pensar si tiene que venir aquí o dónde quizá al final de la sección FORMATOS DE DATOS ESPACIALES En el ámbito del análisis espacial en R, se pueden clasificar el formato de datos espaciales en función del modelo de datos (Lovelace et al., 2019). Se pueden distinguir dos tipos de modelos de datos: vectores y raster. 3.2 Datos de vectores Este modelo está basado en puntos georeferenciados. Los puntos pueden representar localizaciones específicas, como la localización de edificios: library(ggplot2) library(sf) # Hospitales en Toledo segun Eurostat hosp_toledo &lt;- st_read(&quot;data/hosp_toledo.geojson&quot;, quiet = TRUE) # Plot ggplot() + geom_sf( data = hosp_toledo, aes(fill = &quot;Centros Sanitarios&quot;), color = &quot;blue&quot; ) + labs( caption = &quot;Datos: Eurostat&quot;, title = &quot;Hospitales y Centros de Salud en Toledo&quot;, fill = &quot;&quot; ) + theme_minimal() + theme(legend.position = &quot;bottom&quot;) Figura 3.1: Datos vector: Puntos Estos puntos también pueden estar conectados entre sí, de manera que formen geometrías más complejas, como líneas y polígonos: tajo &lt;- st_read(&quot;data/tajo_toledo.shp&quot;, quiet = TRUE) toledo &lt;- st_read(&quot;data/toledo_ciudad.gpkg&quot;, quiet = TRUE) ggplot(toledo) + geom_sf(fill = &quot;cornsilk2&quot;) + geom_sf(data = tajo, col = &quot;lightblue2&quot;, lwd = 2, alpha = 0.7) + geom_sf(data = hosp_toledo, col = &quot;blue&quot;) + coord_sf( xlim = c(-4.2, -3.8), ylim = c(39.8, 39.95) ) + theme_minimal() Figura 3.2: Datos vector: Puntos, líneas y polígonos En la Fig. 3.2, el río Tajo está representado como una línea (sucesión de puntos unidos entre sí) y la ciudad de Toledo como un polígono (línea de puntos cerrada formando un continuo). A modo ilustrativo, la Fig. 3.3 representa la descomposición en puntos de todos los datos espaciales representados en la Fig. 3.2. Figura 3.3: Datos vector: Descomposición en puntos 3.3 Datos raster Los datos ráster son datos representandos en una rejilla rectangular de píxeles (denomindada matriz) que se puede visualizar en diversos dispositivo de representación. El caso más cotidiano de un ráster es una fotografía, donde la imagen se representa como una serie de celdas, determinadas por la resolución de la imagen (número total de píxeles, determinados como número de píxeles en cada fila por número de píxeles en cada columna) y el color que presenta cada uno de estos píxeles. En el ámbito de los datos espaciales, la definición es muy similar. Un archivo ráster está formado por una malla regular de píxeles georreferenciada, tal y como muestra la Fig. 3.4: library(raster) elev &lt;- raster(&quot;data/Toledo_DEM.tiff&quot;) plot(elev, main = &quot;Elevación de la provincia de Toledo&quot;) # Mostramos el grid pols &lt;- rasterToPolygons(elev) plot(pols, add = TRUE, border = &quot;grey90&quot;) # Añadimos la provincia Tol_prov &lt;- st_read(&quot;data/Toledo_prov.gpkg&quot;, quiet = TRUE) # Si queremos solamente la forma en sf, usamos st_geometry plot(st_geometry(Tol_prov), add = TRUE) Figura 3.4: Datos ráster En la Fig. 3.4, el objeto ráster elev tiene únicamente una capa (denominada ESP_alt). Eso implica que cada píxel tiene asociado un único valor, en este caso, en este caso la altitud media del terreno observada: Tabla 3.1: Datos de un ráster (detalle) x y Toledo_DEM -5.391667 40.3 1498.312 -5.358333 40.3 1701.125 -5.325000 40.3 1825.312 -5.291667 40.3 1739.062 -5.258333 40.3 1756.062 -5.225000 40.3 1659.688 -5.191667 40.3 1607.375 -5.158333 40.3 1809.562 -5.125000 40.3 1874.625 -5.091667 40.3 1691.312 -5.058333 40.3 1511.500 -5.025000 40.3 1207.000 -4.991667 40.3 1160.125 -4.958333 40.3 1396.125 -4.925000 40.3 1624.125 Figura 3.5: Datos ráster: Detalle Los rásters pueden contener varias capas (o layers), de manera que cada píxel puede tener asociados varios valores. Volviendo al ejemplo de la fotografía, en un modelo simple de color RGB cada píxel lleva asociado 3 valores (rojo, verde o azul), de manera que al combinar las tres capas se puede definir un color distinto en cada píxel. En la Fig. 3.6 vamos a usar una imagen de mapa georreferenciada, como las proporcionadas por servicios de mapas online, para analizar su composición. Figura 3.6: Datos ráster con varias bandas El ráster se puede descomponer en las tres capas RGB mencionadas anteriormente: Tabla 3.2: Datos de un ráster multicapa (detalle) x y lyr.1 lyr.2 lyr.3 -5.466412 40.34418 215.2128 208.1061 190.5410 -5.463875 40.34418 228.0369 223.1854 211.2115 -5.461338 40.34418 229.3495 224.3414 213.4325 -5.458800 40.34418 215.8592 208.8660 191.2922 -5.456263 40.34418 219.2696 212.8231 196.6812 -5.453725 40.34418 235.0954 231.4222 222.4115 -5.451188 40.34418 240.3514 237.9094 231.4736 -5.448651 40.34418 237.2358 233.7561 226.2005 -5.446113 40.34418 229.9570 225.3262 214.6201 -5.443576 40.34418 226.7812 221.6796 209.2929 -5.441038 40.34418 222.3593 216.5022 202.0188 -5.438501 40.34418 220.9312 214.9060 200.0306 -5.435964 40.34418 224.7755 219.2661 206.2156 -5.433426 40.34418 222.0479 216.0124 201.6103 -5.430889 40.34418 225.0516 219.8074 207.0263 Figura 3.7: Datos ráster multicapa: Descomposición Figura 3.8: Datos ráster multicapa: Descomposición 3.4 Sistema de Referencia de Coordenadas (CRS) Un sistema de referencia de coordenadas (o CRS por sus siglas en inglés, Coordinate Reference System) permite relacionar datos espaciales con su localización en la superficie terrestre. Los CRS constituyen por tanto un aspecto fundamental en el análisis y representación de datos espaciales, ya que nos permiten identificar con exactitud la posición de los datos sobre el globo terráqueo. Así mismo, cuando se trabaja con datos espaciales provenientes de distintas fuentes de información, es necesario comprobar que dichos datos se encuentran definidos en el mismo CRS: Figura 3.9: Representación de mismos valores de coordenadas en distintos CRS En la Fig. 3.9, ambos puntos (verde y rojo) tienen los mismos valores de coordenadas en los ejes X e Y, en este caso las correspondientes a la ciudad de Toledo. Sin embargo, presentan distintos CRS. Por este motivo, al representar ambos puntos en un mapa, se observa que no se están refiriendo a la misma localización geográfica. Esto es así porque el CRS define la referencia (punto x=0 e y =0) y las unidades de los ejes (grados, metros, millas). Como conclusión, además de disponer de las coordenadas de los datos espaciales, es necesario conocer el CRS en el que están definidos para conocer de manera exacta su localización geográfica. Además, nótese que para cualquier análisis de datos espaciales es necesario que todos los geodatos se encuentren referenciados en el mismo CRS. Esto se consigue transformando (o proyectando) los datos a un CRS común, nunca sobreescribiendo el CRS de los mismos. 3.4.1 Tipos de CRS A continuación se definen los dos grandes tipos de CRS, los CRS geográficos y los CRS proyectados. 3.4.1.1 CRS geográficos Los CRS geográficos son aquellos en los que los parámetros empleados para localizar una posición espacial son la latitud y la longitud: Latitud: Es la distancia angular expresada en grados sobre el plano definido por el ecuador terrestre. Determina la posición sobre de una localización en el eje Norte-Sur de la Tierra y toma valores en el rango \\([-90º,90º]\\) . Las líneas imaginarias determinadas por una sucesión de puntos con la misma latitud a lo largo del eje Este-Oeste se denominan paralelos (Ver Fig. 3.10). Longitud: Es la distancia angular expresada en grados sobre el plano definido por el meridiano de Greenwich. Determina la posición sobre de una localización en el eje Este-Oeste de la Tierra y toma valores en el rango \\([-180º,180º]\\) . Las líneas imaginarias determinadas por una sucesión de puntos con la misma longitud a lo largo del eje Este-Oeste se denominan meridianos (Ver Fig. 3.10). Figura 3.10: Paralelos y Meridianos terrestres Es muy importante destacar que en un sistema de coordenadas geográfico, es decir, basado en latitudes y longitudes, las distancias entre dos puntos representan distancias angulares. Por ejemplo, la distancia entre el meridiano de Greenwich y el meridiano correspondiente a la longitud 20º siempre es de +20º. Sin embargo, debido a la forma esférica de la Tierra, la longitud en metros entre ambos meridianos no es constante. Figura 3.11: Distancia entre meridianos en distintas latitudes 3.4.1.2 CRS proyectados La representación de formas tridimensionales en un soporte plano (dos dimensiones) presenta algunos retos. Por ello, es habitual trabajar con proyecciones de mapas. Una proyección geográfica es un método para reducir la superficie de la esfera terrestre a un sistema cartesiano de dos dimensiones. Para ello, es necesario transformar las coordenadas longitud y latitud en coordenadas cartesianas x e y. Es importante destacar que las proyecciones pueden incluir un punto de origen (X=0, Y=0) y unas unidades de distancia (habitualmente metros) específicas. Por ejemplo, la proyección cónica equiáreas de Albers (específica para Estados Unidos) define su punto de referencia (0,0) en la latitud 40º N y longitud 96º, y la unidad de variación están definida en metros. De ahí la importancia de conocer el CRS de los datos geográficos, como se expuso al principio de este tema. El Anexo A proporciona más información sobre los tipos de CRS proyectados. 3.4.2 Trabajando con proyecciones en R Existe toda una serie de proyecciones predefinidas, identificadas mediante los códigos EPSG, ESRI, WKT o proj4 (en desuso en R, pero todavía admitidos). Existen varios recursos web donde se pueden consultar y seleccionar los códigos correspondientes: https://epsg.io/ https://spatialreference.org/ https://proj.org/operations/projections/index.html Algunos de los códigos de proyecciones que es fundamental conocer son: EPSG: 4326: Proyección correspondiente a WGS 84, que es el sistema usado por los sistemas GPS. Cuando trabajemos con coordenadas geográficas longitud/latitud, este es habitualmente el CRS de referencia. EPSG: 3857: Código correspondiente a la proyección de Mercator, usada habitualmente por servicios como Google Maps, etc. Se pueden consultar otros CRS de uso común en España en la página del Ministerio de Agricultura, Pesca y Alimentación En la sección 3.4.3 veremos cómo encontrar un CRS usando el paquete crsuggest. El paquete sf permite obtener los parámetros de cualquier proyección mediante la función st_crs(): (i) EPSG WGS 84 (Sistema Global GPS): EPSG 4326 library(sf) # Ejemplo: EPSG WGS 84 (Sistema Global GPS): EPSG 4326 st_crs(4326) #&gt; Coordinate Reference System: #&gt; User input: EPSG:4326 #&gt; wkt: #&gt; GEOGCRS[&quot;WGS 84&quot;, #&gt; DATUM[&quot;World Geodetic System 1984&quot;, #&gt; ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563, #&gt; LENGTHUNIT[&quot;metre&quot;,1]]], #&gt; PRIMEM[&quot;Greenwich&quot;,0, #&gt; ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]], #&gt; CS[ellipsoidal,2], #&gt; AXIS[&quot;geodetic latitude (Lat)&quot;,north, #&gt; ORDER[1], #&gt; ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]], #&gt; AXIS[&quot;geodetic longitude (Lon)&quot;,east, #&gt; ORDER[2], #&gt; ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]], #&gt; USAGE[ #&gt; SCOPE[&quot;Horizontal component of 3D system.&quot;], #&gt; AREA[&quot;World.&quot;], #&gt; BBOX[-90,-180,90,180]], #&gt; ID[&quot;EPSG&quot;,4326]] (ii) ESRI North America Albers Equal Area Conic: ESRI:102008 # Usando código ESRI North America Albers Equal Area Conic st_crs(&quot;ESRI:102008&quot;) #&gt; Coordinate Reference System: #&gt; User input: ESRI:102008 #&gt; wkt: #&gt; PROJCRS[&quot;North_America_Albers_Equal_Area_Conic&quot;, #&gt; BASEGEOGCRS[&quot;NAD83&quot;, #&gt; DATUM[&quot;North American Datum 1983&quot;, #&gt; ELLIPSOID[&quot;GRS 1980&quot;,6378137,298.257222101, #&gt; LENGTHUNIT[&quot;metre&quot;,1]]], #&gt; PRIMEM[&quot;Greenwich&quot;,0, #&gt; ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433]]], #&gt; CONVERSION[&quot;North_America_Albers_Equal_Area_Conic&quot;, #&gt; METHOD[&quot;Albers Equal Area&quot;, #&gt; ID[&quot;EPSG&quot;,9822]], #&gt; PARAMETER[&quot;Latitude of false origin&quot;,40, #&gt; ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433], #&gt; ID[&quot;EPSG&quot;,8821]], #&gt; PARAMETER[&quot;Longitude of false origin&quot;,-96, #&gt; ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433], #&gt; ID[&quot;EPSG&quot;,8822]], #&gt; PARAMETER[&quot;Latitude of 1st standard parallel&quot;,20, #&gt; ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433], #&gt; ID[&quot;EPSG&quot;,8823]], #&gt; PARAMETER[&quot;Latitude of 2nd standard parallel&quot;,60, #&gt; ANGLEUNIT[&quot;Degree&quot;,0.0174532925199433], #&gt; ID[&quot;EPSG&quot;,8824]], #&gt; PARAMETER[&quot;Easting at false origin&quot;,0, #&gt; LENGTHUNIT[&quot;metre&quot;,1], #&gt; ID[&quot;EPSG&quot;,8826]], #&gt; PARAMETER[&quot;Northing at false origin&quot;,0, #&gt; LENGTHUNIT[&quot;metre&quot;,1], #&gt; ID[&quot;EPSG&quot;,8827]]], #&gt; CS[Cartesian,2], #&gt; AXIS[&quot;(E)&quot;,east, #&gt; ORDER[1], #&gt; LENGTHUNIT[&quot;metre&quot;,1]], #&gt; AXIS[&quot;(N)&quot;,north, #&gt; ORDER[2], #&gt; LENGTHUNIT[&quot;metre&quot;,1]], #&gt; USAGE[ #&gt; SCOPE[&quot;Not known.&quot;], #&gt; AREA[&quot;North America - onshore and offshore: Canada - Alberta; British Columbia; Manitoba; New Brunswick; Newfoundland and Labrador; Northwest Territories; Nova Scotia; Nunavut; Ontario; Prince Edward Island; Quebec; Saskatchewan; Yukon. United States (USA) - Alabama; Alaska (mainland); Arizona; Arkansas; California; Colorado; Connecticut; Delaware; Florida; Georgia; Idaho; Illinois; Indiana; Iowa; Kansas; Kentucky; Louisiana; Maine; Maryland; Massachusetts; Michigan; Minnesota; Mississippi; Missouri; Montana; Nebraska; Nevada; New Hampshire; New Jersey; New Mexico; New York; North Carolina; North Dakota; Ohio; Oklahoma; Oregon; Pennsylvania; Rhode Island; South Carolina; South Dakota; Tennessee; Texas; Utah; Vermont; Virginia; Washington; West Virginia; Wisconsin; Wyoming.&quot;], #&gt; BBOX[23.81,-172.54,86.46,-47.74]], #&gt; ID[&quot;ESRI&quot;,102008]] (iii) Usando proj4string: Robinson: +proj=robin # Usando proj4string: Robinson st_crs(&quot;+proj=robin&quot;) #&gt; Coordinate Reference System: #&gt; User input: +proj=robin #&gt; wkt: #&gt; PROJCRS[&quot;unknown&quot;, #&gt; BASEGEOGCRS[&quot;unknown&quot;, #&gt; DATUM[&quot;World Geodetic System 1984&quot;, #&gt; ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563, #&gt; LENGTHUNIT[&quot;metre&quot;,1]], #&gt; ID[&quot;EPSG&quot;,6326]], #&gt; PRIMEM[&quot;Greenwich&quot;,0, #&gt; ANGLEUNIT[&quot;degree&quot;,0.0174532925199433], #&gt; ID[&quot;EPSG&quot;,8901]]], #&gt; CONVERSION[&quot;unknown&quot;, #&gt; METHOD[&quot;Robinson&quot;], #&gt; PARAMETER[&quot;Longitude of natural origin&quot;,0, #&gt; ANGLEUNIT[&quot;degree&quot;,0.0174532925199433], #&gt; ID[&quot;EPSG&quot;,8802]], #&gt; PARAMETER[&quot;False easting&quot;,0, #&gt; LENGTHUNIT[&quot;metre&quot;,1], #&gt; ID[&quot;EPSG&quot;,8806]], #&gt; PARAMETER[&quot;False northing&quot;,0, #&gt; LENGTHUNIT[&quot;metre&quot;,1], #&gt; ID[&quot;EPSG&quot;,8807]]], #&gt; CS[Cartesian,2], #&gt; AXIS[&quot;(E)&quot;,east, #&gt; ORDER[1], #&gt; LENGTHUNIT[&quot;metre&quot;,1, #&gt; ID[&quot;EPSG&quot;,9001]]], #&gt; AXIS[&quot;(N)&quot;,north, #&gt; ORDER[2], #&gt; LENGTHUNIT[&quot;metre&quot;,1, #&gt; ID[&quot;EPSG&quot;,9001]]]] La mayoría de los objetos espaciales serán de la clase sf, por tanto, resulta interesante conocer cómo se proyectan estos objetos. Es posible proyectar un objeto sf mediante la función st_transform(). En el siguiente ejemplo vemos cómo partimos de un objeto con EPSG:4326 y cambiamos su proyección a otras proyecciones, como Mercator o Robinson: # Usa datos del paquete giscoR library(giscoR) paises &lt;- gisco_get_countries() # Comprobamos el CRS de estos datos # Se puede almacenar en un objeto y usar posteriormente # Vemos que es EPSG:4326, por tanto son coordenadas geográficas longitud/latitud st_crs(paises) #&gt; Coordinate Reference System: #&gt; User input: EPSG:4326 #&gt; wkt: #&gt; GEOGCS[&quot;WGS 84&quot;, #&gt; DATUM[&quot;WGS_1984&quot;, #&gt; SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563, #&gt; AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]], #&gt; AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]], #&gt; PRIMEM[&quot;Greenwich&quot;,0, #&gt; AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]], #&gt; UNIT[&quot;degree&quot;,0.0174532925199433, #&gt; AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]], #&gt; AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]] # Plot plot(st_geometry(paises), axes = TRUE) Figura 3.12: Proyección del mundo en coordenadas geográficas (EPSG 4326) # Proyectamos a Mercator # El eje cambia porque Mercator usa metros paises_merc &lt;- st_transform(paises, st_crs(3857)) plot(st_geometry(paises_merc), axes = TRUE) Figura 3.13: Proyección del mundo en Mercator (EPSG 3857) # Proyectamos a Robinson paises_robin &lt;- st_transform(paises, st_crs(&quot;+proj=robin&quot;)) plot(st_geometry(paises_robin), axes = TRUE) Figura 3.14: Proyección del mundo en Robinson (+proj=robin) Como se comentó anteriormente, cuando se usan geodatos de diversas fuentes, es necesario que todos presenten el mismo CRS. En la Fig 3.15 se muestra lo que ocurre si esto no se cumple: # Añadimos a este mapa puertos mundiales de giscoR puertos &lt;- gisco_get_ports() plot(st_geometry(paises_robin), main = &quot;Puertos en el mundo&quot;) plot(st_geometry(puertos), add = TRUE, col = &quot;red&quot;, pch = 20) Figura 3.15: Ejemplo: Puertos del mundo Vemos que ha habido algún tipo de error, ¿a que puede deberse? # Comprueba CRS st_crs(puertos) == st_crs(paises_robin) #&gt; [1] FALSE # Los puertos no están en Robinson! Proyectamos al mismo CRS puertos_robin &lt;- st_transform(puertos, st_crs(paises_robin)) plot(st_geometry(paises_robin), main = &quot;Puertos en el mundo&quot;) plot(st_geometry(puertos_robin), add = TRUE, col = &quot;blue&quot;, pch = 20) Figura 3.16: Ejemplo: Puertos del mundo, CRS alineados Como vemos, en el primer mapa (Fig. 3.15) los puertos se concentran en un único punto, dado que no están referenciados en el mismo CRS. Tras proyectarlos al mismo CRS, el mapa se representa adecuadamente (Fig. 3.16). En otros paquetes, como sp o raster, existen funciones parecidas que nos van a permitir obtener los parámetros de un CRS y proyectar los objetos al CRS deseado. Cuando empleemos el paquete sp podemos usar las funciones CRS() y spTransform(): library(sp) # Convertimos sf a sp paises_sp &lt;- as(paises, &quot;Spatial&quot;) # En sp podemos usar: # CRS(&quot;+proj=robin&quot;) # # O también desde sf # CRS(st_crs(paises_robin)$proj4string) paises_sp_robin &lt;- spTransform(paises_sp, CRS(&quot;+proj=robin&quot;)) plot(paises_sp_robin) Figura 3.17: Transformaciones en sp En el caso de un objeto raster, podemos usar crs() y projectRaster(): library(raster) # Extrae información de altitud para España elev &lt;- raster(&quot;data/ESP_msk_alt.grd&quot;) # Transforma elev_robinson &lt;- projectRaster(elev, crs = crs(&quot;+proj=robin&quot;)) plot(elev_robinson) Figura 3.18: Transformaciones en raster Por último, en el paquete terra las funciones correspondientes son crs() y project(): library(terra) # Convierte de raster a terra elev_terra &lt;- rast(elev) # Transforma elev_terra_robinson &lt;- terra::project(elev_terra, terra::crs(elev_terra)) plot(elev_terra_robinson) Figura 3.19: Transformaciones en terra 3.4.3 ¿Qué proyección uso? El CRS adecuado para cada análisis depende de la localización y el rango espacial de los datos. Un CRS adecuado para representar un mapa del mundo puede no serlo para representar datos de zonas específicas de la Tierra. Los recursos web mencionados anteriormente permiten la búsqueda de CRS por zona geográfica, y adicionalmente en R existe el paquete crsuggest (Walker, 2021) que nos facilita la labor, sugiriendo el CRS más adecuado para cada zona: library(crsuggest) # Usando raster sugerencias &lt;- suggest_crs(elev) Tabla 3.3: Tabla sugerencias, detalle crs_code crs_name crs_type crs_gcs crs_units crs_proj4 2062 Madrid 1870 (Madrid) / Spain LCC projected 4903 m +proj=lcc +lat_1=40 +lat_0=40 +lon_0=0 +k_0=0.9988085293 +x_0=600000 +y_0=600000 +a=6378298.3 +rf=294.73 +pm=madrid +units=m +no_defs 2154 RGF93 / Lambert-93 projected 4171 m +proj=lcc +lat_0=46.5 +lon_0=3 +lat_1=49 +lat_2=44 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 26191 Merchich / Nord Maroc projected 4261 m +proj=lcc +lat_1=33.3 +lat_0=33.3 +lon_0=-5.4 +k_0=0.999625769 +x_0=500000 +y_0=300000 +ellps=clrk80ign +towgs84=31,146,47,0,0,0,0 +units=m +no_defs 3944 RGF93 / CC44 projected 4171 m +proj=lcc +lat_0=44 +lon_0=3 +lat_1=43.25 +lat_2=44.75 +x_0=1700000 +y_0=3200000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 3943 RGF93 / CC43 projected 4171 m +proj=lcc +lat_0=43 +lon_0=3 +lat_1=42.25 +lat_2=43.75 +x_0=1700000 +y_0=2200000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 27573 NTF (Paris) / Lambert zone III projected 4807 m +proj=lcc +lat_1=44.1 +lat_0=44.1 +lon_0=0 +k_0=0.999877499 +x_0=600000 +y_0=3200000 +ellps=clrk80ign +pm=paris +towgs84=-168,-60,320,0,0,0,0 +units=m +no_defs 27572 NTF (Paris) / Lambert zone II projected 4807 m +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +ellps=clrk80ign +pm=paris +towgs84=-168,-60,320,0,0,0,0 +units=m +no_defs 27563 NTF (Paris) / Lambert Sud France projected 4807 m +proj=lcc +lat_1=44.1 +lat_0=44.1 +lon_0=0 +k_0=0.999877499 +x_0=600000 +y_0=200000 +ellps=clrk80ign +pm=paris +towgs84=-168,-60,320,0,0,0,0 +units=m +no_defs 30791 Nord Sahara 1959 / Nord Algerie projected 4307 m +proj=lcc +lat_1=36 +lat_0=36 +lon_0=2.7 +k_0=0.999625544 +x_0=500135 +y_0=300090 +a=6378249.145 +rf=293.465 +towgs84=-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547 +units=m +no_defs 30493 Voirol 1879 / Nord Algerie (ancienne) projected 4671 m +proj=lcc +lat_1=36 +lat_0=36 +lon_0=2.7 +k_0=0.999625544 +x_0=500000 +y_0=300000 +ellps=clrk80ign +units=m +no_defs # Probamos sugerencia crs_suggest &lt;- suggest_crs(elev, limit = 1) elev_suggest &lt;- projectRaster(elev, crs = raster::crs(crs_suggest$crs_proj4)) plot(elev_suggest) Figura 3.20: raster: Ejemplo de transformación usando crsuggest # Ejemplo con sf: China china &lt;- gisco_get_countries(country = &quot;China&quot;) china_crs &lt;- suggest_crs(china, limit = 1) china_crs #&gt; # A tibble: 1 x 6 #&gt; crs_code crs_name crs_type crs_gcs crs_units crs_proj4 #&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; #&gt; 1 4584 New Beijing / Gauss-Kruger CM 105E projected 4555 m +proj=tmerc +lat_0=0 +lo~ china_suggest &lt;- st_transform( china, st_crs(as.integer(china_crs$crs_code)) ) plot(st_geometry(china_suggest), axes = TRUE) Figura 3.21: sf: Ejemplo de transformación usando crsuggest References Lovelace, R., Nowosad, J., &amp; Muenchow, J. (2019). Geocomputation with R. CRC Press. Walker, K. (2021). crsuggest: Obtain suggested coordinate reference system information for spatial data. "],["estadística-espacial.html", "Capítulo 4 Estadística espacial 4.1 Antes de continuar dependencia espacial. 4.2 Datos espaciales 4.3 Clasificación de datos espaciales", " Capítulo 4 Estadística espacial La estadística espacial reconoce y aprovecha la ubicación espacial de los datos a la hora de diseñar, recopilar, gestionar, analizar y mostrar las observaciones. Éstas son generalmente dependientes, si bien existen modelos espaciales a disposición del investigador que permiten tratar con dicha dependencia espacial a la hora de llevar a cabo labores de predicción. Por extensión, la estadística espacio-temporal incorpora, además, el tiempo y su interacción con el espacio como argumento de ayuda en tales labores predictivas. Las mediciones y modelos espaciales están presentes, sorprendentemente, en una amplia variedad de disciplinas científicas. Los orígenes de la vida humana vinculan los estudios de la evolución de las galaxias, la estructura de las células biológicas y los patrones de asentamiento arqueológicos. Los ecologistas estudian las interacciones entre plantas y animales. Silvicultores y agricultores necesitan investigar las variaciones que se producen en el terreno para sus experimentos. La estimación de las precipitaciones y de las reservas de oro y petróleo es de vital importancia económica. Estos son, entre otros, buenos ejemplos de la importancia del espacio (espacio-tiempo en su caso) en el mundo de la Ciencia. Sin embargo, el estudio de la variabilidad espacial, y sobre todo espacio-temporal, es una disciplina relativamente nueva en el marco de la Estadística, lo que explica la escasez de instrumentos de estadística espacial 30 años atrás. En los últimos 10 años ha habido una creciente toma de conciencia de esta necesidad, habiéndose realizado un gran esfuerzo por buscar herramientas adecuadas y útiles a tales efectos. Y todo ello porque utilizar modelos espaciales o espacio-temporales para caracterizar y explotar la dependencia espacial (o espacio-temporal) de un conjunto de observaciones tiene importantes ventajas (Montero, Fernández-Avilés, Mateu, &amp; Porcu (2011)): Modelos más generales, ya que, en la mayoría de los casos, los modelos clásicos que no tienen en consideración la dimensión espacial o la interacción de las dimensiones espacial y temporal son un caso particular de un modelo espacial o espacio-temporal. Estimaciones más eficientes: de la tendencia, de los efectos de las variables explicativas, de promedios regionales, Mejora de las predicciones: más eficientes, con propiedades de extrapolación más estables, La variación espacial no explicada en la estructura de la media debe ser absorbida por la estructura del error, por lo que un modelo que incorpore la dependencia espacial puede decirse que está protegido frente a una mala especificación de este tipo. Esto, en muchos casos, tiene como resultado una simplificación en la especificación de la tendencia; en general, los modelos con dependencia espacial suelen tener una descripción más parsimoniosa (en ocasiones con muchos menos parámetros) que los clásicos modelos de superficie de tendencia. 4.1 Antes de continuar dependencia espacial. Frecuentemente los datos tienen una componente espacial y/o temporal asociada a ellos y es de esperar que datos cercanos en el espacio o en el tiempo sean más semejantes que aquellos que están más alejados; en cuyo caso no deben ser modelados como estadísticamente independiente, sino que habrá que tomar en cuenta esa dependencia espacial o espacio-temporal. De forma natural y de acuerdo a la Ley Tobler (1973) surge la idea de que los datos cercanos en el espacio o en el tiempo serán más similares y estarán más correlacionados entres sí que aquellos que están más lejanos. Además, esta correlación disminuye al aumentar la separación entre ellos, por lo que se puede pensar en la presencia de una dependencia espacial o espacio-temporal. Esto da lugar al concepto de proceso espacial o espacio-temporal. Si los datos no exhiben dependencia espacial no tiene sentido aplicar las herramientas de estadística espacial. Veamos un ejemplo simulado de unos datos que muestras dependencia espacial y otros puramente aleatorios. La Fig. 4.1 muestra unos datos simulados que presentan una estructura de dependencia espacial (panel izquierdo) frente a unos datos totalmente aleatorios (panel derecho), en ambos casos distribuidos de forma irregular en el espacio. #&gt; &#39;RandomFields&#39; will use OMP Figura 4.1: Puntos: Ejemplo de independencia espacial La Fig. 4.2, al igual que la Fig. 4.1 presenta unos datos simulados donde que presentan una estructura de dependencia espacial (panel izquierdo) frente a unos datos totalmente aleatorios (panel derecho), pero en este caso estos datos se distribuyen de forma ordenada en el espacio a través de una rejilla regular. Figura 4.2: Rejilla: Ejemplo de independencia especial 4.2 Datos espaciales Los datos espaciales, también conocidos como datos geoespaciales, son aquellos datos relacionados o que contienen información de una localización o área geográfica de la superficie de la Tierra. La forma más intuitiva de representar los datos espaciales es a través de un mapa. # Mapa de porcentaje de mujeres en Castilla-La Mancha library(mapSpain) # Datos de población pob &lt;- mapSpain::pobmun19 # Datos en forma de tabla, sin información en formato espacial # head(pob) # Porcentaje pob$porc_mujeres &lt;- pob$women / pob$pob19 * 100 # Datos espaciales geo &lt;- esp_get_munic(region = &quot;Castilla-La Mancha&quot;) # Estos datos tienen una columna (geometry) con coordenadas. # head(geo) # Une ambos datos geo_pob &lt;- merge(geo, pob, by = c(&quot;cpro&quot;, &quot;cmun&quot;), all.x = TRUE ) # Mapa básico plot(geo_pob[&quot;porc_mujeres&quot;], # Cambiamos titulo main = &quot;Castilla-La Mancha: % mujeres (2019)&quot;, # Cambiamos la paleta de colores para hacerlo mas atractivo # border = NA, pal = hcl.colors(12, &quot;RdYlBu&quot;) ) Figura 4.3: Porcentaje de Mujeres en Castilla-La Mancha La Fig. 4.3 presenta una serie de elementos gráficos, característicos de los objetos espaciales: Los municipios de Castilla-la Mancha están representados por polígonos con un contorno negro y se rellenan de colores de acuerdo con la variable que estamos analizando, el porcentaje de mujeres en los municipios de Castilla-La Mancha en el año 2019. Una leyenda explica el significado de los colores. La variable, el porcentaje de mujeres en los municipios de Castilla-La Mancha en el año 2019, no parece distribuirse de manera independiente sino todo lo contrario, muestra un patrón espacial. Los municipios del las provincias Guadalajara y Cuenca (noreste) presentan tasas más bajas que los municipios del centro de la Comunidad. head(geo_pob[&quot;porc_mujeres&quot;]) #&gt; Simple feature collection with 6 features and 1 field #&gt; Geometry type: POLYGON #&gt; Dimension: XY #&gt; Bounding box: xmin: -2.18037 ymin: 38.5441 xmax: -1.31112 ymax: 39.35597 #&gt; Geodetic CRS: ETRS89 #&gt; porc_mujeres geometry #&gt; 1 52.02532 POLYGON ((-1.58316 39.20446... #&gt; 2 43.93064 POLYGON ((-1.40607 39.12384... #&gt; 3 51.14089 POLYGON ((-2.0562 38.88697,... #&gt; 4 48.55491 POLYGON ((-1.54055 38.61066... #&gt; 5 48.78419 POLYGON ((-1.38514 39.35429... #&gt; 6 44.49541 POLYGON ((-2.15635 38.71074... Antes de dibujar la Fig. 4.3 tuvimos que leer los datos de la librería mapSpain (Hernangómez, 2022) que contenía tanto la variable que hemos analizado como el formato del mapa. Tras unir variable y mapa con la función merge(). Al llevar a cabo un resumen del objeto espacial nos encontramos con las siguiente información: el conjunto de datos (seleccionado) tiene 919 registros (municipios) el tipo de geometría es POLYGON. el CRS es ETRS89 4.3 Clasificación de datos espaciales Tal y como acabamos de señalar y de acuerdo con Schabenberger y Gotway (2005, p. 6), debido a que los datos espaciales surgen en una gran variedad de campos y aplicaciones, también hay una gran variedad de tipos de datos espaciales, estructuras y escenarios. Por tanto, una clasificación exhaustiva de los datos espaciales sería un reto muy difícil y hemos apostado por una clasificación general, simple y útil de datos espaciales proporcionada por Cressie (1993). La clasificación de Cressie de datos espaciales se basa en la naturaleza del dominio espacial en estudio. Dependiendo de esto, podemos tener: datos geoestadísticos, datos de patrones de puntos y datos latice (véase Fig. 4.4, tomada de Hengl (2009)). Figura 4.4: Clasificación de datos espaciales propuesta propuesta por Cressie (1993) GEMA: PUEDES REVISAR LA FORMULA? Siguiendo a Cressie (1993), sea \\(s  \\^d\\) una localización en un espacio Euclideo \\(d-\\)dimensional y \\({Z(s) s  \\^d}\\) una función aleatoria espacial, donde \\(Z\\) representa el atributo en el cual estamos interesados: Datos geoestadísticos: Surgen cuando el dominio de estudio es continuo y fijo \\(D\\). Es decir: (i) \\(Z(s)\\) se puede observar en cualquier punto del dominio (continuo); y (ii) los puntos en \\(D\\) no son estocásticos (son fijos, \\(D\\) es el mismo para todas las realizaciones de la función aleatoria espacial ). Algunos ejemplos de datos geoestadísticos son el nivel de un contaminante en una ciudad, los valores de precipitación o temperatura del aire en un país, las concentraciones de metales pesados en la capa superior del suelo de una región, etc. Es obvio que, al menos en teoría, el nivel de un contaminante específico podría medirse en cualquier lugar de la ciudad; Lo mismo puede decirse de las mediciones de precipitaciones o temperaturas del aire en un país o concentraciones de un metal pesado en una región. Sin embargo, en la práctica, no es posible una observación exhaustiva del proceso espacial. Por lo general, el proceso espacial se observa en un conjunto de ubicaciones (por ejemplo, el nivel de un contaminante específico en una ciudad se observa en los puntos donde están ubicadas las estaciones de monitoreo) y, basado en tales valores observados, el análisis geoestadístico reproduce el comportamiento de el proceso espacial en todo el dominio de interés. En el análisis geoestadístico lo más importante es cuantificar la correlación espacial entre observaciones (a través de la herramienta básica en geoestadística, el semivariograma) y utilizar esta información para lograr los objetivos anteriores. # ejemplo cual??? tmin interpolado Datos reticulares: Surgen cuando: (i) el dominio bajo estudio \\(D\\) es discreto, es decir, \\(Z(s)\\) puede observarse en una serie de ubicaciones fijas que pueden enumerarse. Estas ubicaciones pueden ser puntos o regiones, pero generalmente son códigos postales, pistas censales, vecindarios, provincias, países, etc., y los datos en la mayoría de los casos son datos agregados espacialmente sobre estas áreas. Aunque estas regiones pueden tener una forma regular, normalmente la forma que tienen es irregular, y esto, junto con el carácter espacialmente agregado de la datos, es por lo que los datos latice tambien se denominan datos regionales. Y (ii) las ubicaciones en \\(D\\) no son estocásticas. Por supuesto, un concepto clave en el análisis de los datos lattice es el vecindario y la matriz W. Algunos ejemplos de reticulares incluyen la tasa de desempleo por estados, los datos de delincuencia por comarcas, rendimientos agrícolas en parcelas, precios medios de la vivienda por provincias, etc. # ejemplo ¿¿ el de la renta?? Procesos de puntos: Mientras que en los datos geoestadísticos y reticulares el dominio \\(D\\) es fijo, en los datos de patrones puntuales el dominio es discreto o continuo, pero aleatorio. Los patrones de puntos surgen cuando el atributo bajo estudio es la ubicación de los eventos (observaciones). Es decir, el interés radica en dónde ocurren eventos de interés. Algunos ejemplos de patrones de puntos son la ubicación de incendios en una región española, la ubicación de los árboles en un bosque o la ubicación de nidos en una colonia de aves reproductoras, la localización de los delitos en una ciudad, entre muchas otras. En estos En los casos, es obvio que D es aleatorio y los puntos de observación no dependen del investigador. El principal objetivo del análisis de patrones de puntos es determinar si la ubicación de los eventos tiende a exhibir un patrón sistemático sobre el área en estudio o, por el contrario, son aleatoriamente repartido. Más concretamente, nos interesa analizar si la ubicación de los eventos es completamente aleatorio espacialmente (la ubicación donde ocurren los eventos no se ve afectada por la ubicación de otros eventos), uniforme o regular (cada punto está tan lejos de todos sus vecinos como sea posible) o agrupados o agregados (la ubicación de los eventos se concentra en grupos). # ejemplo, el de los accidentes?? References Cressie, N. A. C. (1993). Statistics for spatial data. John Wiley; Sons, Inc. https://doi.org/10.1002/9781119115151 Hernangómez, D. (2022). mapSpain: Administrative boundaries of Spain (Version 0.5.0). https://doi.org/10.5281/zenodo.5366622 Montero, J. M., Fernández-Avilés, G., Mateu, J., &amp; Porcu, E. (2011). Geoestadística espacial y espacio-temporal: Vino nuevo, cepas viejas (pp. 163178). Riobóo; Riobóo (Eds.) Historia de la Probabilidad y la Estadística. "],["referencias.html", "Referencias", " Referencias Abrahart, R. J., Openshaw, S., Abrahart, R. J., &amp; See, L. M. (Eds.). (2000). Geocomputation. CRC Press. https://doi.org/10.4324/9780203305805 Cressie, N. A. C. (1993). Statistics for spatial data. John Wiley; Sons, Inc. https://doi.org/10.1002/9781119115151 Hernangómez, D. (2022). mapSpain: Administrative boundaries of Spain (Version 0.5.0). https://doi.org/10.5281/zenodo.5366622 Lovelace, R., Nowosad, J., &amp; Muenchow, J. (2019). Geocomputation with R. CRC Press. Montero, J. M., Fernández-Avilés, G., Mateu, J., &amp; Porcu, E. (2011). Geoestadística espacial y espacio-temporal: Vino nuevo, cepas viejas (pp. 163178). Riobóo; Riobóo (Eds.) Historia de la Probabilidad y la Estadística. Rees, I., P y Turton. (1998). Guest Editorial. Environment and Planning A: Economy and Space, 30(10), 18351838. https://doi.org/10.1068/a301835 Walker, K. (2021). crsuggest: Obtain suggested coordinate reference system information for spatial data. "],["crsproy.html", "Anexo A Tipos de CRS proyectados A.1 Por tipo de superficie de proyección A.2 Por métrica a preservar", " Anexo A Tipos de CRS proyectados Existen varias familias de proyecciones, que se pueden clasificar de diversas maneras: por tipo de superficie de proyección y por métrica a preservar. A.1 Por tipo de superficie de proyección El proceso de trasladar puntos de una esfera a un plano puede plantearse de manera práctica como el ejercicio de envolver una esfera con una superificie plana (como una hoja de papel) y trasladar los puntos de la esfera de manera lineal al punto de la superficie plana más cercano a ella. La Fig. A.1 muestra estos tres tipos de proyección. Figura A.1: Tipos de proyección por superficie de proyección A partir de este ejercicio, se plantean tres posibles soluciones (cilíndrica, cónica y acimutal o planar), dependiendo del tipo de superficie que se use para proyectar. Proyecciones cilíndricas: Son aquellas proyecciones donde la superficie de proyección conforma un cilindro alrededor de la Tierra. Una de las proyecciones cilíndricas más conocidas es la proyección de Mercator (Ver Fig. A.2). Figura A.2: Proyección Mercator Proyecciones cónicas: En este tipo de proyecciones, se plantea la superficie de proyección como una forma cónica. Como ejemplo, la proyección cónica equiáreas de Albers es una de las proyecciones que más suele usarse en la representación de mapas de América del Norte (Ver Fig. A.3). Figura A.3: Proyección cónica equiáreas de Albers Proyecciones acimutales o planares: En este tipo de proyección se proyecta una porción de la Tierra sobre un plano que es tangente a la misma en el punto de referencia. Como ejemplos de proyecciones acimutales podemos destacar la proyección ortográfica (Ver Fig. A.4). Figura A.4: Proyección ortogonal A.2 Por métrica a preservar Es importante tener en cuenta que cualquier proyección de la superficie de la Tierra produce distorsiones en una o varias características geográficas. Como ejemplo clásico, la proyección de Mercator produce distorsiones del tamaño especialmente en aquellas regiones más cercanas a los polos (Groenlandia, que la proyección de Mercator presenta una área similar a la de África, tiene menor superficie real que Argelia). Otras de las métricas que suele verse distorsionada son la distancia entre dos puntos geográficos, la dirección o la forma de regiones de la Tierra. A lo largo de la Historia se han desarrollado diversas proyecciones cuyo objetivo es preservar alguna o varias de las propiedades mencionadas anteriormente, sin embargo es importante destacar que no existe una proyección que sea capaz de preservar todas las métricas a la vez. Según la metrica a presevar, las proyecciones se pueden clasificar en: Proyecciones conformales: Intentan preservar los ángulos que se forman en la superficie terrestre. Por ejemplo, la proyección de Mercator representa ángulos rectos en las intersecciones de los paralelos y los meridianos (Ver Fig. A.5). Figura A.5: Ejemplo de proyección conformal: Mercator Proyecciones equivalentes: Preservan las proporciones de las áreas, provocando a su vez deformaciones en el resto de características, como la forma o los ángulos. La proyección acimutal equivalente de Lambers es un tipo de proyección equivalente (Ver Fig. A.6). Figura A.6: Ejemplo de proyección equivalente: Proyección acimutal equivalente de Lambers Proyecciones equidistantes: Preservan la distancia entre dos puntos geográficos específicos. Por ejemplo, la proyección Plate carré preserva la distancia entre el Polo Norte y el Polo Sur (Ver Fig. A.7). Figura A.7: Ejemplo de proyección equidistante: Platé carre Proyecciones de compromiso: No intentan preservar ninguna métrica en concreto. En su lugar, se centran en intentar encontrar un equilibrio entre las diversas distorsiones que provocan para intentar dar una representación más o menos representativa de la superficie terrestre. La proyección de Winkel Tripel, usada en los mapas de National Geographic, es un ejemplo de proyección de compromiso (Ver Fig. A.8). Figura A.8: Ejemplo de proyección de compromiso: Winkel Tripel En los anteriores ejemplos se ha añadido a cada proyección la indicatriz de Tissot. Ésta consiste en una serie de círculos imaginarios de igual área distribuidos sobre la superficie esférica de la Tierra en determinados puntos. De este manera, al presentar la indicatriz de Tissot en una proyección específica, se puede entender de una manera intuitiva la distorsión provocada por dicha proyección, ya que los círculos se ven distorsionados o preservados según los parámetros y la naturaleza de la proyección en cuestión. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
